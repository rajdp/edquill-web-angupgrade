import { expect } from 'chai';
import { spy } from 'sinon';
import { combineSVGElementCreators, stateToSvg } from '../src/SVG/StateToSvg';
describe('CombineSVGElementCreators', function () {
    var resultDomElement = { test: 'test' };
    var svgElementCreators = {
        someType: function () { return (resultDomElement); },
    };
    var stateToSvgMapper = combineSVGElementCreators(svgElementCreators);
    var document = {};
    it('should throw unknown type exception', function () {
        var element = {
            type: 'some test type'
        };
        expect(function () { return stateToSvgMapper(document, element); }).throw('Unknown element type: some test type');
    });
    it('should return dom element', function () {
        var document = {};
        var element = {
            type: 'someType'
        };
        var result = stateToSvgMapper(document, element);
        expect(result).deep.equal(resultDomElement);
    });
});
describe('StateToSvg', function () {
    var someDomElement = { outerHTML: 'test outerHTML', appendChild: spy(), dataset: { id: 0 } };
    var someChildDomElement = { innerHTML: 'test child innerHTML', dataset: { id: 1 }, getAttribute: function () { return 1; } };
    var groupDomElement = { innerHTML: 'group test innerHTML', appendChild: spy(), children: [someChildDomElement] };
    var svgElementCreators = {
        someType: function () { return someDomElement; },
        someChildType: function () { return someChildDomElement; }
    };
    var stateToSvgMapper = combineSVGElementCreators(svgElementCreators);
    var document = {
        createElementNS: spy(function () { return groupDomElement; })
    };
    var svgContainer = {
        appendChild: spy(),
        removeChild: spy()
    };
    var state = {
        elements: [{ type: 'someType', children: [{ id: 0, type: 'someChildType' }] }]
    };
    beforeEach(function () {
        document.createElementNS.resetHistory();
        svgContainer.appendChild.resetHistory();
        someDomElement.appendChild.resetHistory();
        groupDomElement.appendChild.resetHistory();
        svgContainer.removeChild.resetHistory();
    });
    it('should create group element', function () {
        stateToSvg(document, svgContainer, stateToSvgMapper);
        var createElementArgs = document.createElementNS.getCalls().map(function (call) { return call.args; });
        var expectedCreateElementArgs = [['http://www.w3.org/2000/svg', 'g']];
        expect(expectedCreateElementArgs).deep.equal(createElementArgs);
        var appendChildArgs = svgContainer.appendChild.getCalls().map(function (call) { return call.args; });
        var expectedAppendChildArgs = [[groupDomElement]];
        expect(expectedAppendChildArgs).deep.equal(appendChildArgs);
    });
    it('should append child to parent element', function () {
        stateToSvg(document, svgContainer, stateToSvgMapper)(state);
        var appendChildArgs = someDomElement.appendChild.getCalls().map(function (call) { return call.args; });
        var expectedAppendChildArgs = [[someChildDomElement]];
        expect(expectedAppendChildArgs).deep.equal(appendChildArgs);
    });
});
//# sourceMappingURL=StateToSvg.test.js.map
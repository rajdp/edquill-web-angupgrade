<script src="answering.component.spec.ts"></script>
<div *ngIf="commondata.loader.value" id="pre-loader">
    <img alt="" src="assets/images/pre-loader/loader-01.svg">
</div>
<div style="padding: 10px 0 !important" class="container-fluid" id="yourTarget">

    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="row align-items-center">
                    <div class="col-12">
                        <div class="card-body {{env.deviceType() ? 'px-3 py-2' : ''}}">
                            <div class="row pr-3 my-1 d-flex align-items-center">
                                <div class="col-md-{{getData?.is_test == 1 && getData.student_content_status == '1' &&
                                    getData.student_content_status == '2' ? '5' : '6'}} mt-2 pl-4">
                                    <h4 class="mb-1 font-weight-bold">{{contentName}}</h4>
                                    <div style="margin-top: 12px" class="col-12 px-0 d-flex" *ngIf="!showpdf">
                                        <div class="position-relative" #qnsWrapper>
                                            <button *ngIf="questionData.file_text != ''" (click)="showDescription = !showDescription;showCalculator = false"
                                                    class="px-2 py-1 btn cancel description_button">
                                                Description<app-feather-icons [icon]="'clipboard'"></app-feather-icons></button>
                                            <div class="description_box" *ngIf="showDescription">
                                                <div class="box-title d-flex justify-content-between">
                                                    <span>Description</span>
                                                    <i class="fa fa-close cursor" (click)="showDescription = !showDescription;showCalculator = false"></i>
                                                </div>
                                                <div class="col-12 mb-0 pl-0 editor_bullet" *ngIf="questionData.file_text != ''">
                                                    <span [innerHTML]="questionData.file_text | sanitizeHtml"></span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="position-relative ml-{{questionData.file_text != '' ? '2' : '0'}}" *ngIf="getData?.is_test == '1' && ['math', 'maths'].indexOf(getData?.subject.toLowerCase()) > -1">
                                            <button (click)="toggleCalculator();showReference = false;showDescription = false" class="align-items-center px-2 py-1 btn cancel description_button">
                                                Calculator<i class="fa fa-calculator ml-2" aria-hidden="true"></i></button>
                                            <div class="calculator_box" cdkDrag *ngIf="showCalculator">
                                                <div class="box-title d-flex justify-content-between drag-handle" cdkDragHandle>
                                                    <div class="col-11 px-0">
                                                        <span>Calculator</span>
                                                        <p style="font-size: 12px; font-weight: 500">Note: Click on the header to move the widget</p>
                                                    </div>
                                                    <div class="col-1 px-0 align-self-center text-right" (click)="showCalculator = !showCalculator;showReference = false;showDescription = false">
                                                        <i class="fa fa-close cursor"></i>
                                                    </div>
                                                </div>
                                                <div class="col-12 mb-0 pl-0">
                                                    <div id="calculator" style="width: 100%; height: 400px;"></div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="position-relative ml-2" *ngIf="getData?.is_test == '1' && ['math', 'maths'].indexOf(getData?.subject.toLowerCase()) > -1">
                                            <button (click)="showReference = !showReference;showDescription = false;showCalculator = false" class="align-items-center px-2 py-1 btn cancel description_button">
                                                Reference<i class="fa fa-file-text ml-2" aria-hidden="true"></i></button>
                                            <div class="calculator_box" *ngIf="showReference">
                                                <div class="box-title d-flex justify-content-between">
                                                    <span>Reference</span>
                                                    <i class="fa fa-close cursor" (click)="showReference = !showReference;showDescription = false;showCalculator = false"></i>
                                                </div>
                                                <div class="col-12 mb-0 pl-0">
                                                    <div style="width: 100%; height: 400px;">
                                                        <pdf-viewer
                                                                [src]="pdfSrc"
                                                                [render-text]="true"
                                                                [original-size]="false"
                                                                style="display: block;height: 100%;"
                                                                [show-all]="true"
                                                                [fit-to-page]="true"
                                                                [autoresize]="true">
                                                        </pdf-viewer>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-{{getData?.is_test == 1 && getData.student_content_status == '1' &&
                                    getData.student_content_status == '2' ? '7' : '6'}} px-0 pdf-assign-btn d-flex align-items-center justify-content-end">
                                    <div class="d-flex align-items-center col-4 p-0" *ngIf="getData?.is_test == 1 &&
                                        getData.student_content_status != '1' && getData.student_content_status != '2'">
                                        <ng-select class="m-0 w-100" (change)="changeQuestionListFromTest($event)"
                                                   [items]="testContentDetail"
                                                   bindLabel="name"
                                                   bindValue="content_id"
                                                   [(ngModel)]="testContentData"
                                                   placeholder="Content List"
                                                   [clearable]="false">
                                            <ng-template ng-option-tmp let-item="item">
                                                <div title="{{item.name}}">{{item.name}}</div>
                                            </ng-template>
                                        </ng-select>
                                    </div>
                                    <div (click)="getData.student_content_status == '1' || getData.student_content_status == '2' ? (showTimer = !showTimer) : ''"
                                         class="row my-0 {{showTimer ? 'py-1 justify-content-center mx-2' : 'py-2 mr-1'}} px-2 timer_button"
                                         *ngIf="!showpdf && !isSingleQnsWithFeedbackType || (!showpdf && questionData?.show_timer == '1' && isSingleQnsWithFeedbackType)">
                                        <div class="w-auto text-center"
                                             *ngIf="(showTimer && (getData.student_content_status == '1' || getData.student_content_status == '2')) ||
                                              (getData.student_content_status != '1' && getData.student_content_status != '2' && overallTimeTaken > 3600)">
                                            <h4 style="font-size: 24px" class="mb-0"><b>{{overallElapsedTime?.hours}}</b></h4>
                                            <span style="font-size: 12px" class="color-primary mb-0">Hours</span>
                                        </div>
                                        <div class="w-auto mx-2" style="margin-top: 2px" *ngIf="(showTimer && (getData.student_content_status == '1' || getData.student_content_status == '2')) ||
                                              (getData.student_content_status != '1' && getData.student_content_status != '2' && overallTimeTaken > 3600)">
                                            <h4 class="mb-0 font-weight-bold">:</h4>
                                        </div>
                                        <div class="w-auto text-center" *ngIf="showTimer">
                                            <h4 style="font-size: 24px" class="mb-0"><b>{{overallElapsedTime?.minutes}}</b></h4>
                                            <span style="font-size: 12px" class="color-primary mb-0">Minutes</span>
                                        </div>
                                        <div class="w-auto mx-2" style="margin-top: 2px" *ngIf="showTimer">
                                            <h4 class="mb-0 font-weight-bold">:</h4>
                                        </div>
                                        <div class="w-auto text-center" *ngIf="showTimer">
                                            <h4 style="font-size: 24px" class="mb-0"><b>{{overallElapsedTime?.seconds}}</b></h4>
                                            <span style="font-size: 12px"  class="color-primary mb-0">Seconds</span>
                                        </div>
                                        <div class="align-content-center" *ngIf="getData.student_content_status == '1' || getData.student_content_status == '2'">
                                            <i *ngIf="showTimer" title="Hide Timer" class="cursor fa fa-eye ml-2 color-primary"></i>
                                            <i *ngIf="!showTimer" title="Show Timer" class="cursor fa fa-eye-slash color-primary"></i>
                                        </div>
                                    </div>
                                    <div class="row mx-2">
                                        <div ngbDropdown container="body">
                                            <i style="font-size: 24px !important;" id="gfg2" *ngIf="showUploadFile && functionCalled && !expandPdf" ngbDropdownToggle
                                               [hidden]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                               class="fa fa-upload color-primary icon d-inline-flex" aria-hidden="true" title="Upload PDF">
                                                <div class="ml-3" *ngIf="answerPdf.length != 0">
                                                    <span class="upload-count">({{answerPdf.length}})</span>
                                                </div>
                                                <div ngbDropdownMenu="gfg2">
                                                    <div class="col-md-12 text-center" *ngIf="answerPdf.length == 0">
                                                        <label class="px-2 mb-0 color-primary">No PDF File Uploaded</label>
                                                    </div>
                                                    <div class="col-md-12 px-0 justify-content-between align-items-center d-flex"
                                                         *ngFor="let item of answerPdf; let i = index">
                                                        <label class="px-2 mb-0 color-primary" ngbDropdownItem>{{item.image}}</label>
                                                        <i (click)="deletePdf(i)"
                                                           [hidden]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                           aria-hidden="true" class="fa fa-close px-3" style="cursor:pointer"></i>
                                                    </div>
                                                    <div class="col-md-12 d-flex justify-content-center mt-2" *ngIf="showUploadFile">
                                                        <input #hiddenfileinput (change)="encodePdfFileAsURL($event)" accept=".pdf"
                                                               multiple style="display: none" type="file">
                                                        <button (click)="hiddenfileinput.click()"
                                                                [hidden]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                                aria-describedby="inputGroupFileAddon01"
                                                                class="btn-sm btn-outline-primary mb-2 ml-2 pull-right button1"
                                                                type="file">Upload pdf
                                                        </button>
                                                    </div>
                                                </div>
                                            </i>
                                        </div>
                                        <a *ngIf="questionData?.download != '0' && !expandPdf && functionCalled"
                                           [download]="downloadTemplateName" [href]="downloadTemplate">
                                            <i class="fa fa-download color-primary icon" title="Download PDF" aria-hidden="true"></i>
                                        </a>
                                        <i *ngIf="questionData?.teacher_feedback != '' && questionData?.teacher_feedback && functionCalled && !expandPdf"
                                           title="Teacher Feedback" class="fa fa-commenting-o icon color-primary" aria-hidden="true" (click)="showFeedback()"></i>
                                        <img *ngIf="linkdata?.length != '0'" style="border: 1px solid #8F008A; border-radius: 4px; padding: 0; width: 34px; height: 34px; margin-right: 12px" alt="Resource"
                                             src="assets/images/mob-side-icon/books.png" title="Resources" (click)="otherlink()">
                                        <i title="Save & Exit" (click)="saveAnswer('2', 'exit', true, 'same')"
                                           *ngIf="(getData.student_content_status == '1' || getData.student_content_status == '2') && getData?.is_test != '1' && !isSingleQnsWithFeedbackType"
                                           class="fa fa-sign-out color-primary icon" aria-hidden="true"></i>
                                        <i title="Save" (click)="saveAnswer('2', 'noExit', true, 'same')" *ngIf="(getData.student_content_status == '1' || getData.student_content_status == '2') && !isSingleQnsWithFeedbackType"
                                           class="fa fa-floppy-o color-primary icon" aria-hidden="true"></i>
                                        <button (click)="finalPopUp()"
                                                *ngIf="(getData.student_content_status == '1' || getData.student_content_status == '2') && getData?.is_test != '1' && !isSingleQnsWithFeedbackType"
                                                class="btn btn-primary pull-right {{env.deviceType() ? 'border-radius-5' : ''}}">Submit
                                        </button>
                                        <!--                    <button (click)="saveAnswer('2', 'noExit', true, 'same')" *ngIf="getData.student_content_status == '1' || getData.student_content_status == '2'" class="btn btn-outline-primary pull-right ml-2">Save</button>-->
                                        <!--                    <button (click)="saveAnswer('2', 'exit', true, 'same')" *ngIf="getData.student_content_status == '1' || getData.student_content_status == '2'" class="btn btn-outline-primary pull-right">Save and Exit</button>-->
                                        <!--                    <button *ngIf="linkdata?.length != '0'" class="btn btn-primary pull-right mx-2" (click)="otherlink()">Resources</button>-->
                                        <button (click)="backbutton()" *ngIf="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                class="btn btn-outline-primary pull-right ml-2 {{env.deviceType() ? 'border-radius-5' : ''}}">Back
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div *ngIf="showpdf" class="row">
        <!--        <div *ngIf="functionCalled && answerPdf.length > 0" class="col-md-12 px-0 d-flex flex-wrap justify-content-start flex-row-reverse">-->
        <!--            <div *ngFor="let item of answerPdf; let i = index" class="col-md-4 pr-0">-->
        <!--                <div class="col-md-12 justify-content-between align-items-center custom-card d-flex mt-2 mb-2">-->
        <!--                    <label class="px-2 mb-0 color-primary">{{item.image}}</label>-->
        <!--                    <i (click)="deletePdf(i)" [hidden]="getData.student_content_status != '1' && getData.student_content_status != '2'" aria-hidden="true" class="fa fa-close px-3" style="cursor:pointer"></i>-->
        <!--                </div>-->
        <!--            </div>-->
        <!--        </div>-->
        <div class="col-md-{{expandPdf ? '12' : '8'}}">
            <!--            <div *ngIf="(getData.student_content_status == '1' || getData.student_content_status == '2') && !env.deviceType() && showWorkArea">-->
            <!--                <app-annotation (annotate)="getWorkAreaAnnotation($event)"-->
            <!--                                [getAnnotate]="workAnnotate"-->
            <!--                                [id]="'workArea'"-->
            <!--                                [toolAdjust]="true"-->
            <!--                                [toolHide]="true"-->
            <!--                                [userType]="'student'"></app-annotation>-->
            <!--            </div>-->
            <div *ngIf="!functionCalled" id="custom-pdf-loader" style="height: 100vh;">
                <img alt="" src="assets/images/pre-loader/loader-01.svg">
            </div>
            <div class="col-md-12" *ngIf="pdf && functionCalled && !isPdfAvailable">
                <app-source-link [pdfPath]="pdfPath[0]"></app-source-link>
            </div>
            <app-annotation *ngIf="pdf && functionCalled && isPdfAvailable && !env.deviceType()"
                            [getAnnotate]="areaInfo"
                            [userType]="'student'"
                            (annotate)="getAreaInfo($event)"
                            (deleteAnnotation)="getDeleteAction($event)"
                            (currentPageNo)="getCurrentPageNo($event)"
                            (expandBoolean)="expandPdfSize($event)"
                            [pageVariable]="scrolledPageNumber"
                            [showPageNo]="showAutoScroll"
                            [pdfPath]="pdfTemplate"
                            [expandPdf]="true"
                            [getDragQues]="dragQuestion"
                            [toolHide]="getData.student_content_status != '1' && getData.student_content_status != '2'"></app-annotation>

            <app-student-web-annotation *ngIf="pdf && functionCalled && isPdfAvailable && env.deviceType()"
                                        [expandPdf]="true"
                                        (expandBoolean)="expandPdfSize($event)"
                                        [overallData]="overallFullData"
            ></app-student-web-annotation>
        </div>
        <div *ngIf="functionCalled && !expandPdf" class="col-md-{{pdf == true ? 4 : 12}} px-0">
            <div class="col-md-12 px-0 d-flex justify-content-between {{env.deviceType() ? 'align-items-center' : ''}} ">
                <div *ngIf="totalAns.length != 0" class="col-md-1 px-0 {{env.deviceType() ? 'mb-2' : ''}}">
                    <img (click)="showPdf()" *ngIf="!pdf" alt=""
                         class="mt-1 {{env.deviceType() ? 'question-side-icon' : ''}}"
                         src="assets/images/pdf-icons/arrowRight.png" title="Show pdf">
                    <img (click)="showPdf()" *ngIf="pdf" alt=""
                         class="mt-1 {{env.deviceType() ? 'question-side-icon' : ''}}"
                         src="assets/images/pdf-icons/arrowLeft.png" title="Hide pdf">
                </div>
                <div *ngIf="showpdf"
                     class="col-md-{{totalAns.length != 0 ? '11' : '12'}} pl-0 pr-3 my-2 d-flex justify-content-end align-items-center">
                    <!--                    <div *ngIf="questionData?.teacher_feedback">-->
                    <!--                        <div *ngIf="questionData?.teacher_feedback != ''" class="d-flex justify-content-end">-->
                    <!--                            <button [attr.aria-controls]="'#teacherFeed'" [attr.data-target]="'#teacherFeed'" aria-expanded="false" class="btn-sm btn-outline-primary" data-toggle="collapse">Teacher Feedback</button>-->
                    <!--                        </div>-->
                    <!--                    </div>-->
                    <select (change)="sectionFilter($event)" *ngIf="totalAnsSample.length > 1 && !expandPdf"
                            [(ngModel)]="sectionFilterVal"
                            class="form-span col-md-{{totalAnsSample.length > 0 && showAutoScroll ? '8' : '12'}}">
                        <option value="all">All Section</option>
                        <option *ngFor="let item of totalAnsSample; let i = index"
                                value="{{i}}">{{item.heading}}</option>
                    </select>
                    <div class="col-md-4 px-0" *ngIf="totalAnsSample.length > 0 && showAutoScroll">
                        <div class="col-md-12 px-0 d-flex justify-content-end align-items-center">
                            <input (change)="allowAutoScroll = !allowAutoScroll" [checked]="allowAutoScroll"
                                   type="checkbox"><label class="ml-2 mb-0"><b>Auto scroll</b></label>
                        </div>
                    </div>
                    <!--                    <input #hiddenfileinput (change)="encodePdfFileAsURL($event)" accept=".pdf" multiple style="display: none" type="file">-->
                    <!--                    <button (click)="hiddenfileinput.click()" *ngIf="showUploadFile" [hidden]="getData.student_content_status != '1' && getData.student_content_status != '2'" aria-describedby="inputGroupFileAddon01"-->
                    <!--                            class="btn-sm btn-outline-primary mb-2 ml-2 pull-right button1"  type="file">Upload pdf</button>-->
                    <!--                    <a *ngIf="questionData?.download != '0'" [download]="downloadTemplateName" [href]="downloadTemplate"  class="button ml-2 pull-right">Download Pdf</a>-->
                </div>
            </div>
            <div class="col-md-12 mb-2" *ngIf="showUploadFile && showpdf">
                <small [hidden]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                       class="col-md-12 px-0 d-flex justify-content-end"
                       style="color: grey; font-weight: bold; align-self: end">Note: Upload PDF size should not
                    exceed {{uploadFileSize.toString()}} MB</small>
            </div>
            <!--            <div *ngIf="questionData.teacher_feedback != ''" class="row mt-3 mb-3 px-3">-->
            <!--                <div class="col-md-12 px-0 collapse" id="teacherFeed">-->
            <!--                    <div class="col-md-12 px-0">-->
            <!--                        <div class="col-md-12 customize-card4">{{questionData.teacher_feedback}}</div>-->
            <!--                    </div>-->
            <!--                </div>-->
            <!--            </div>-->
            <!--            <div class="col-md-12 px-0">-->
            <!--                <div *ngFor="let item of answerPdf; let i = index" class="col-md-12 justify-content-between align-items-center custom-card d-flex mt-2 mb-2">-->
            <!--                    <label class="px-2 mb-0 color-primary">{{item.image}}</label>-->
            <!--                    <i (click)="deletePdf(i)" [hidden]="getData.student_content_status != '1' && getData.student_content_status != '2'" aria-hidden="true" class="fa fa-close px-3" style="cursor:pointer"></i>-->
            <!--                </div>-->
            <!--            </div>-->
            <div *ngIf="questionData.answers.length != 0" class="col-12 px-0 view-question">
                <div (scrolled)="onScrollDown()"
                     (mouseover)="scrollQues($event)"
                     [fromRoot]="true"
                     [infiniteScrollContainer]="'.scrollPanelSide'"
                     [infiniteScrollDistance]="5"
                     [infiniteScrollThrottle]="50"
                     class="scrollPanelSide card {{env.deviceType() ? 'ml-2' : ''}}"
                     id="scrollinnnersection"
                     infiniteScroll>
                    <div *ngFor="let sec of totalAns; let i = index"
                         [hidden]="totalAns == ''"
                         [ngStyle]="{'padding': showpdf === true ? '1rem' : '2rem' }"
                         class=""
                    >
                        <div *ngIf="sec?.heading != ''" class="col-md-{{showpdf == true ? 12 : 6}} px-0 mb-3">
                            <input [value]="sec?.heading" class="input-custom-modal div-disable" type="text">
                        </div>
                        <div *ngFor="let item of sec?.section; let j = index"
                             [id]="item.page_no + '-' + item.sub_question_no + '-' + j" class="mb-3">
                            <div class="row d-flex justify-content-between">
                                <div class="col-md-2 d-flex">
                                    <button class="btn btn-primary">{{item.sub_question_no}}</button>
                                    <i *ngIf="item.answer_status && item.answer_status != '0' && item.answer_status != '1' && item.answer_status != '4'"
                                       class="fa fa-2x fa-check-circle color-green align-self-center ml-2"></i>
                                    <i *ngIf="item.answer_status == '1'"
                                       class="fa fa-2x fa-times-circle color-red align-self-center ml-2"></i>
                                </div>
                                <div *ngIf="item.question_type_id == '40'" class="col-md-6">
                                    <button (click)="openGraph($event, i, j, item)"
                                            class="btn btn-outline-primary pull-right">answer graph
                                    </button>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="mt-4">
                                        <div *ngIf="item.question != ''" [innerHTML]="item.question | sanitizeHtml"
                                             class="mb-0 overflow-auto div-disable" id="{{'questionId'}}"></div>
                                    </div>
                                    <div *ngIf="item.question_type_id == 1">
                                        <div [ngClass]="{'div-disable': getData.student_content_status != '1' && getData.student_content_status != '2'}"
                                             class="row mb-2">
                                            <span (click)="getChooseAns(k, i, j)"
                                                  *ngFor="let option of item.array; let k = index"
                                                  [ngClass]="{'selectColor' : option.trim().toLowerCase() === item.given_answer.trim().toLowerCase() }"
                                                  class="multichoice-option1">{{option}}</span>
                                        </div>
                                    </div>
                                    <div *ngIf="item.question_type_id == 3"
                                         [ngClass]="{'div-disable': getData.student_content_status != '1' && getData.student_content_status != '2'}"
                                         class="d-flex">
                                        <div [ngClass]="{'student-selected': item.given_answer == 'true'}"
                                             class="d-flex align-items-center px-3 py-2">
                                            <input (click)="getTrueAns('true', i , j)"
                                                   [checked]="item?.given_answer == 'true'"
                                                   class="radio-size cursor form-control mr-2"
                                                   id="true{{j}}" name="ans{{j}}" type="radio" value="true">
                                            <label class="mb-0 cursor" for="true{{j}}">True</label>
                                        </div>
                                        <div [ngClass]="{'student-selected': item.given_answer == 'false'}"
                                             class="d-flex align-items-center ml-2 px-3 py-2">
                                            <input (click)="getTrueAns('false', i , j)"
                                                   [checked]="item?.given_answer == 'false'"
                                                   class="radio-size cursor form-control mr-2"
                                                   id="false{{j}}" name="ans{{j}}" type="radio" value="false">
                                            <label class="mb-0 cursor" for="false{{j}}">False</label>
                                        </div>
                                    </div>
                                    <div *ngIf="item.question_type_id == 9"
                                         [ngClass]="{'div-disable': getData.student_content_status != '1' && getData.student_content_status != '2'}">
                                        <div (click)="getDropdownAns(k, i, j)"
                                             *ngFor="let option of item.mob_options; let k = index"
                                             [ngClass]="{'student-selected': option == item.given_answer}"
                                             class="dropdown-list col-md-{{showpdf == true ? 12 : 5}} mb-2 p-2">
                                            <span>{{option}}</span></div>
                                    </div>
                                    <div *ngIf="item.question_type_id == 10" class="col-md-12 mt-4 px-0">
                                    <textarea (input)="getInputAns($event, i, j)"
                                              [readOnly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                              [value]="item.given_answer"
                                              class="form-control mt-2 col-md-{{showpdf == true ? 12 : 5}}"
                                              placeholder="Enter answer here" rows="2"
                                    ></textarea>
                                    </div>
                                    <div *ngIf="item.question_type_id == 20" class="col-md-12 mt-4 px-0">
                                        <textarea (input)="getInputAns($event, i, j)"
                                                  [readOnly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                  [value]="item.given_answer" class="form-control" cols="30"
                                                  rows="8"></textarea>
                                    </div>
                                    <div *ngIf="item.question_type_id == 30" class="col-md-12 mt-2 px-0">
                                        <app-tiny-mice (emitEditorValue)="getNumericAnswerValue($event, i, j)"
                                                       *ngIf="hideRuleAnswer[i]?.section[j]"
                                                       [editorPatchValue]="item.given_answer == '' ? false : item.given_answer"
                                                       [height]="250"
                                                       [id]="i+'giveAns'+j"
                                                       [readonly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                       [showDropBtn]="false"
                                                       [showInputBtn]="false"
                                                       class="mt-2">
                                        </app-tiny-mice>
                                        <div class="d-flex justify-content-start">
                                            <button (click)="setAnswer(i, j)"
                                                    *ngIf="!hideRuleAnswer[i]?.section[j] && item.question_type_id == 30 && item.given_answer == ''"
                                                    [disabled]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                    class="btn-sm mb-1 btn-outline-primary mr-2">Add Answer
                                            </button>
                                            <button (click)="setAnswer(i, j)"
                                                    *ngIf="!hideRuleAnswer[i]?.section[j] && item.question_type_id == 30 && item.given_answer != ''"
                                                    [disabled]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                    class="btn-sm mb-1 btn-outline-primary mr-2">Edit Answer
                                            </button>
                                            <!--                                            <button (click)="submitAnswer(item.given_answer1 , i ,j)" *ngIf="hideRuleAnswer[i].section[j] && item.question_type_id == 30"-->
                                            <!--                                                    [disabled]="getData.student_content_status != '1' && getData.student_content_status != '2'"-->
                                            <!--                                                    class="btn-sm mb-1 btn-outline-primary mr-2">Submit Answer</button>-->
                                        </div>
                                        <div *ngIf="!hideRuleAnswer[i].section[j]"
                                             class="d-flex mt-2 ml-2 justify-content-start">
                                            <div class="flex-column" style="overflow-y: auto;">
                                                <p style="margin-bottom: 0;">Answer :</p>
                                                <span *ngIf="!hideRuleAnswer[i].section[j] && item.given_answer != ''"
                                                      [innerHTML]="item.given_answer | sanitizeHtml" class=""
                                                      style="overflow-y: auto;"></span>
                                            </div>
                                        </div>
                                    </div>
                                    <!--                                <div *ngIf="item.question_type_id == '40'">-->
                                    <!--                                    <app-graph-component [editMode]="false"-->
                                    <!--                                                         [editPatchValue]="false"-->
                                    <!--                                                         [graphId]="'previewGraph'"-->
                                    <!--                                                         [questionType]="'40'"></app-graph-component>-->
                                    <!--                                </div>-->
                                    <div *ngIf="item.question_type_id == 54" class="col-md-12 mt-4 px-0">
                                        <div *ngFor="let opt of item.answer; let k = index">
                                        <textarea (input)="getBlanksValue($event, k, i, j)"
                                                  [readOnly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                  [value]="item.given_answer[k] ? item.given_answer[k] : ''"
                                                  class="form-control mb-2" placeholder="Enter input-{{k+1}} answer"
                                                  rows="2"
                                        ></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div *ngIf="item.question_type_id != '40'" class="row mt-3 d-flex">
                                <div class="col-md-12">
                                    <button [attr.aria-controls]="'#queries' + j + 'id' + i"
                                            [attr.data-target]="'#queries' + j + 'id' + i"
                                            [disabled]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                            aria-expanded="false" class="btn-sm btn-outline-primary mr-2"
                                            data-toggle="collapse">Feedback
                                    </button>
                                    <button (click)="toggle(i , j)" class="btn-sm btn-outline-primary mr-2">work space
                                    </button>
                                    <button (click)="openWorkArea(item, i, j)" class="btn-sm mb-1 btn-outline-primary"
                                            title="Work Area">Work area
                                    </button>
                                    <button *ngIf="item.question_type_id == '20'" (click)="expandFullScreen(item, i, j)"
                                            class="btn-sm mb-1 btn-outline-primary" style="width: 30px;"
                                            title="Expand Editor"><i aria-hidden="true" class="fa fa-expand"></i>
                                    </button>
                                    <button (click)="expandFullScreen(item, i, j)"
                                            *ngIf="item.question_type_id == '30' && hideRuleAnswer[i].section[j]"
                                            class="btn-sm mb-1 btn-outline-primary mr-2" style="width: 30px;"
                                            title="Expand Editor"><i aria-hidden="true" class="fa fa-expand"></i>
                                    </button>
                                </div>
                            </div>
                            <div *ngIf="item.question_type_id != '40'" class="row mt-3 mb-3">
                                <div class="col-md-12 collapse" id="queries{{j}}id{{i}}">
                                    <textarea (input)="getQueries($event, i, j, 'pdf')" [value]="item.student_feedback"
                                              class="form-control" placeholder="Feedback" rows="3"></textarea>
                                </div>
                            </div>
                            <div *ngIf="item.question_type_id != '40'" class="row mt-3 d-flex">
                                <div class="col-md-12">
                                    <button (click)="submitQueries(i, j, 'pdf')"
                                            *ngIf="queries != '' && queriesIndex == j+'id'+i"
                                            class="btn-sm btn-primary mr-2 {{env.deviceType() ? 'border-radius-5' : ''}}">
                                        Submit
                                    </button>
                                </div>
                            </div>
                            <div *ngIf="item.question_type_id != '40'" class="row mt-3 mb-3">
                                <div *ngIf="this.hideRuleContent[i]?.section[j] == true" class="col-md-12"
                                     id="workspace{{j}}id{{i}}">
                                    <app-tiny-mice (emitEditorValue)="getNumericWorkSpaceValue($event, i, j)"
                                                   *ngIf="this.hideRuleContent[i].section[j] == true"
                                                   [editorPatchValue]="item.student_roughdata"
                                                   [height]="250"
                                                   [id]="i+'workspace'+j"
                                                   [readonly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                   [showDropBtn]="false"
                                                   [showInputBtn]="false">
                                    </app-tiny-mice>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-12 mt-3 card p-4">
                <textarea [(ngModel)]="totalFeedBack"
                          [readOnly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                          class="form-control" cols="30" placeholder="Overall Feedback" rows="5"></textarea>
            </div>
        </div>
        <!--        <div *ngIf="this.questionData.answers.length == 0" class="col-12">-->
        <!--            <div class="col-md-12 mt-3 card p-4">-->
        <!--                <textarea [(ngModel)]="totalFeedBack" [readOnly]="getData.student_content_status != '1' && getData.student_content_status != '2'" class="form-control" cols="30" placeholder="Overall Feedback" rows="5"></textarea>-->
        <!--            </div>-->
        <!--        </div>-->
    </div>

    <section *ngIf="!showpdf" class="content-card row" [ngStyle]="{ 'max-height': totalContentMaxHeight}">
        <div class="{{isSingleQnsWithFeedbackType && previousFeedBack.length != 0 && !feedbackExpanded ? 'col-6 pr-0' : 'col-12'}}">

            <div class="content-card" [ngStyle]="{ 'max-height': contentMaxHeight}" >

                <div class="content-card row view-question px-3 {{['1', '2', '5', '7', '9', '16', '40', '41'].includes(item.question_type_id) ? 'justify-content-center' : ''}}" *ngFor="let item of totalAns; let i = index; let last = last">

                    <div class="col-6 px-0"
                         *ngIf="showQuestion == i && ['10', '20', '24', '28'].indexOf(item.question_type_id) > -1 && !isSingleQnsWithFeedbackType">
                        <div class="card p-4 mb-0" style="min-height: 67vh !important;">
                            <div class="card-body">
                                <div class="row" [ngClass]="{'math' : getData?.is_test == '1' && ['math', 'maths'].includes(getData?.subject.toLowerCase())
                                            , 'rw' : !(getData?.is_test == '1' && ['math', 'maths'].includes(getData?.subject.toLowerCase()))}">
                                    <div class="col-12" *ngIf="['10', '20', '28'].indexOf(item.question_type_id) > -1">

                                        <div class="cfs" style="font-size: 14px;letter-spacing: .5px;color: #313131">
                                            <div>For <strong>student-produced response questions</strong>, solve each problem and write your answer next to or under the question in the test book as described below:</div>

                                            <ul style="list-style-type: disc; padding-left: 20px;">
                                                <li>If you find <strong>more than one correct answer</strong>, enter only one answer.</li>
                                                <li>Your answer can be up to 5 characters for a <strong>positive</strong> answer and up to 6 characters (including the negative sign) for a <strong>negative</strong> answer.</li>
                                                <li>If your answer is a <strong>fraction</strong> that doesn't fit in the provided space, enter the decimal equivalent.</li>
                                                <li>If your answer is a <strong>decimal</strong> that doesn't fit in the provided space, enter it by truncating or rounding at the fourth digit.</li>
                                                <li>If your answer is a <strong>mixed number</strong> (such as 3Â½), enter it as an improper fraction (7/2) or its decimal equivalent (3.5).</li>
                                                <li>Don't enter <strong> symbols </strong> such as a percent sign, comma, or dollar sign.</li>
                                            </ul><br>

                                            <div>Examples:</div><br>
                                            <table border="1" cellspacing="0" cellpadding="10" style="border-collapse: collapse; font-family: Arial, sans-serif; font-size: 14px; text-align: center;">
                                                <thead style="background-color: #f2f2f2;">
                                                <tr>
                                                    <th>Answer</th>
                                                    <th>Acceptable ways to enter answer</th>
                                                    <th>Unacceptable: will NOT receive credit</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr>
                                                    <td>3.5</td>
                                                    <td>3.5</td>
                                                    <td>31/2</td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td>3.50</td>
                                                    <td>3 1/2</td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td>7/2</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td>2/3</td>
                                                    <td>2/3</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td>.6666</td>
                                                    <td>0.66</td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td>.6667</td>
                                                    <td>.66</td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td>0.666</td>
                                                    <td>0.67</td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td>0.667</td>
                                                    <td>.67</td>
                                                </tr>
                                                <tr>
                                                    <td>-1/3</td>
                                                    <td>-1/3</td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td>-.3333</td>
                                                    <td>-.33</td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td>-0.333</td>
                                                    <td>-0.33</td>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <div class="col-12 mt-3" *ngIf="item.question_type_id == '24'">
                                        <div class="ml-2 cfs editor_bullet" *ngIf="item.subQuestions[0]?.passage && item.subQuestions[0]?.passage != ''">
                                            <span [innerHTML]="item.subQuestions[0]?.passage | sanitizeHtml"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="px-0 mb-2 {{isSingleQnsWithFeedbackType ? 'col-md-12' : ['10', '20', '24', '28'].indexOf(item.question_type_id) > -1 ? 'col-md-6' : 'col-md-8'}}" *ngIf="showQuestion == i">
                        <div class="container-fluid {{totalAns.length == 1 && totalAns[0]?.question_type_id != '55' || ['10', '20', '24', '28'].indexOf(item.question_type_id) > -1
                  ? 'pl-2 pr-0' : 'px-0'}}">

                            <div *ngIf="(checkQuestionId(item)?.is_correct == 'true' || checkQuestionId(item)?.is_correct == 'false' || !correctAnswer) && getData?.is_test != '1'">
                                <div class="alert alert-{{checkQuestionId(item)?.is_correct == 'false'|| !correctAnswer ? 'danger' : 'success'}} alert-dismissible fade show">
                                    <strong> {{checkQuestionId(item)?.is_correct == 'false' || !correctAnswer ? 'You have entered Incorrect Answer !' : 'Great Response ! You have entered Correct Answer'}}</strong>
                                    .
                                </div>
                            </div>
                            <div class="card p-4">
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-12 col-md-12">
                                            <div class="row" [ngClass]="{'math' : getData?.is_test == '1' && ['math', 'maths'].includes(getData?.subject.toLowerCase())
                                            , 'rw' : !(getData?.is_test == '1' && ['math', 'maths'].includes(getData?.subject.toLowerCase()))}">
                                                <div class="col-12 d-flex align-items-center px-0 justify-content-between" style="background: #dedede9e">
                                                    <div class="d-flex">
                                                        <button class="button_design btn-primary">{{i + 1}}</button>
                                                        <div class="d-flex align-items-center" *ngIf="!checkDisableConditionForQns(item)">
                                                            <i *ngIf="!item.markedAsReview" (click)="item.markedAsReview = true" title="Review"
                                                               style="font-size: 22px; margin-left: 10px" class="color-primary fa fa-bookmark-o cursor"></i>
                                                            <span *ngIf="!item.markedAsReview" (click)="item.markedAsReview = true"  class="ml-1 color-primary cursor" style="font-size: 12px">- Mark For Review</span>
                                                            <img *ngIf="item.markedAsReview" (click)="item.markedAsReview = false" title="Marked For Review"
                                                                 style="width: 20px; margin-left: 10px" class="cursor" alt="Review Marked" src="assets/images/bookmark_checked.webp">
                                                            <span *ngIf="item.markedAsReview" (click)="item.markedAsReview = false"  class="ml-1 color-primary cursor" style="font-size: 12px">- Marked For Review</span>
                                                        </div>
                                                    </div>
                                                    <div class="px-0 pdf-assign-btn d-flex align-items-center justify-content-end">
                                                        <div [ngStyle]="{'visibility': getData.student_content_status != '1' && getData.student_content_status != '2'
                                                            ? 'unset' : 'hidden'}" class="row my-0 mx-2 justify-content-center">
                                                            <h4 style="font-size: 18px" class="mb-0" *ngIf="getElapsedTime() as elapsed"><b>{{elapsed.minutes}}</b></h4>
                                                            <h4 class="mb-0 font-weight-bold mx-1">:</h4>
                                                            <h4 style="font-size: 18px" class="mb-0" *ngIf="getElapsedTime() as elapsed"><b>{{elapsed.seconds}}</b></h4>
                                                        </div>
                                                        <i [title]="feedbackExpanded ? 'Collapse Question' : 'Expand Question'" class="fa {{feedbackExpanded ? 'fa-compress' : 'fa-expand'}} expand_collapse_design"
                                                           (click)="feedbackExpanded = !feedbackExpanded" *ngIf="isSingleQnsWithFeedbackType && previousFeedBack.length != 0"></i>
                                                    </div>
                                                </div>

                                                <div class="col-12 mt-4" *ngIf="item.question != '' && item.question_type_id == 55">
                                                    <div class="cfs editor_bullet">
                                                        <p class="overflow-auto pl-2" [innerHTML]="convertMarkdownToHtml(item.question)"></p>
                                                    </div>
                                                </div>

                                                <div class="col-12 mt-4" *ngIf="item.question_type_id == '24' && item.subQuestions[0]?.question != ''">
                                                    <div class="ml-2 cfs editor_bullet" *ngIf="item.subQuestions[0]?.question && item.subQuestions[0]?.question != ''">
                                                        <span style="color: #777;font-size: 13px;" [innerHTML]="item.subQuestions[0]?.question | sanitizeHtml"></span>
                                                    </div>
                                                </div>

                                                <div class="cfs mt-4 editor_bullet" *ngIf="item.question != '' && item.question_type_id != 24 && item.question_type_id != 55">
                                                    <b><h3 [innerHTML]="item.question | sanitizeHtml" class="mb-0 pl-3"></h3></b>
                                                </div>

                                            </div>
                                        </div>

                                        <div class="col-md-12" [ngClass]="{'math' : getData?.is_test == '1' && ['math', 'maths'].includes(getData?.subject.toLowerCase())
                                            , 'rw' : !(getData?.is_test == '1' && ['math', 'maths'].includes(getData?.subject.toLowerCase()))}">
                                            <div *ngIf="item.question_type_id == 1 || item.question_type_id == 2"
                                                 [ngClass]="{'div-disable': checkDisableConditionForQns(item)}">
                                                <div class="col-md-12 mb-2 px-2">
                                                    <div (click)="option.eliminated ? '' : cfsGetMultiChoice(i, k, item)" [ngClass]="{'student-selected' : k.toString() == option.isSelected}"
                                                         *ngFor="let option of item.given_answer; let k = index"
                                                         class="{{option.eliminated ? '' : 'cursor'}} overflow-auto row my-3 mx-0 p-2"
                                                         style="max-height: 20rem">
                                                        <button [ngClass]="{'disabled': option.eliminated}" class="btn-primary inner_button">{{((k+1) + 9).toString(36).toUpperCase()}}</button>
                                                        <div class="col-11 pr-0 cfs align-self-center">
                                                    <span [ngClass]="{'eliminated-option': option.eliminated}">
                                                        <span [innerHTML]="option.options | sanitizeHtml" class="math-content remove-margin-bottom"></span>
                                                    </span>
                                                        </div>

                                                        <div class="pl-2 align-self-center cursor" (click)="toggleEliminator($event, item, k)" *ngIf="['1', '2'].includes(getData.student_content_status) && !(k.toString() == option.isSelected)">
                                                            <i *ngIf="!option.eliminated" title="Strike out the option" class="eliminator fas fa-strikethrough"></i>
                                                            <i *ngIf="option.eliminated" title="Undo the strike out" class="fa fa-undo"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div *ngIf="item.question_type_id == 5 || item.question_type_id == 7"
                                                 [ngClass]="{'div-disable': checkDisableConditionForQns(item)}"
                                                 class="mt-4 px-3 table-flexible">
                                                <table class="table table-bordered text-center">
                                                    <thead>
                                                    <tr>
                                                        <th>Questions</th>
                                                        <th *ngFor="let list of item.answer; let k=index"
                                                            [innerHTML]="list | sanitizeHtml" class="remove-margin-bottom"
                                                            id="{{'columnId' + i}}"></th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    <tr *ngFor="let list of item.given_answer; let j=index">
                                                        <td [innerHTML]="list.options | sanitizeHtml"
                                                            class="remove-margin-bottom"></td>
                                                        <td *ngFor="let ans of item.answer; let k=index">
                                                            <input (click)="cfsGetChooseTable(item, i, j, k)"
                                                                   *ngIf="item.question_type_id == '5'"
                                                                   [checked]="this.totalAns[i].given_answer[j].isSelected == '' ? false : this.totalAns[i].given_answer[j].isSelected == k.toString()"
                                                                   class="cursor radio_animated" id="{{j}}chooseSingle{{i}}"
                                                                   name="{{i}}choosesingle{{j}}corect" type="radio">
                                                            <input (click)="cfsGetChooseTable(item, i, j, k)"
                                                                   *ngIf="item.question_type_id == '7'"
                                                                   [checked]="splitMultiChoose(this.totalAns[i].given_answer[j].isSelected, k)"
                                                                   id="{{j}}chooseMulti{{i}}" class="cursor" type="checkbox">
                                                        </td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </div>

                                            <div *ngIf="item.question_type_id == 9" class="mt-4"
                                                 [ngClass]="{'div-disable': checkDisableConditionForQns(item)}">
                                                <div *ngFor="let data of item.given_answer; let j = index" class="col-md-12 mt-3 mb-3">
                                                    <label>Dropdown - {{j + 1}}</label>
                                                    <div class="col-md-11 dropdown">
                                                        <button type="button" [id]="i + 'dropdown' + j"
                                                                [innerHTML]="data.isSelected === '' ? 'Select Answer' : data.options[data.isSelected].correctAnswer | sanitizeHtml"
                                                                class="col-md-12 bg-white innerhtml-margin-clear p-2 dropdown-border dropdown-toggle d-flex justify-content-between"
                                                                data-toggle="dropdown"></button>
                                                        <div class="col-md-11 dropdown-menu">
                                                    <span (click)="cfsGetDropdown($event, i, j, '', 'Select Answer')"
                                                          class="dropdown-item dropdown-link cursor">Select Answer</span>
                                                            <span (click)="cfsGetDropdown($event, i, j, k, list.listOption)"
                                                                  *ngFor="let list of data.options; let k = index"
                                                                  [innerHTML]="list.listOption | sanitizeHtml" style="overflow: scroll; overflow-y: hidden"
                                                                  class="dropdown-item dropdown-link innerhtml-margin-clear"></span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div *ngIf="item.question_type_id == 10" class="mt-4"
                                                 [ngClass]="{'div-disable': checkDisableConditionForQns(item)}">
                                                <div *ngFor="let data of item.given_answer; let j = index"
                                                     class="col-md-6 mt-3 mb-3">
                                                    <label>Input - {{j + 1}}</label>
                                                    <input (input)="cfsGetInput($event, i, j, item)" *ngIf="item.editor_type == 1"
                                                           placeholder="Enter the Answer"
                                                           [readOnly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                           [value]="data.isSelected" class="form-control" type="text">
                                                    <app-tiny-mice (emitEditorValue)="cfsGetInput($event, i, j, item)"
                                                                   *ngIf="item.editor_type != 1"
                                                                   [editorPatchValue]="data.isSelected == '' ? false : data.isSelected"
                                                                   [height]="100"
                                                                   [id]="i+'input'+j"
                                                                   [readonly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                                   [showDropBtn]="false"
                                                                   [showInputBtn]="false"
                                                                   class="mt-2">
                                                    </app-tiny-mice>
                                                </div>
                                            </div>

                                            <div *ngIf="item.question_type_id == 16" class="mt-4"
                                                 [ngClass]="{'div-disable': checkDisableConditionForQns(item)}">
                                                <div class="col-md-12">
                                                    <div (cdkDropListDropped)="droppedCorrect($event, i)" cdkDropList
                                                         class="col-12">
                                                        <div *ngFor="let list of item.given_answer; let k=index"
                                                             class="input-group mb-3 mt-3 inputMenu">
                                                            <div cdkDrag class="input-group mb-1 inputMenu">
                                                                <div class="input-group-prepend">
                                                            <span class="input-group-text px-0 py-1">
                                                                <img class="img-fluid" src="assets/images/pdf-icons/equal@2x.png" alt="">
                                                            </span>
                                                                </div>
                                                                <h4 style="min-height: 46px" [innerHTML]="list.options | sanitizeHtml"
                                                                    class="form-control mb-0 overflow-auto align-content-center"></h4>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div *ngIf="['20'].indexOf(item.question_type_id) > -1" class="mt-4 px-3 mb-3"
                                                 [ngClass]="{'div-disable': checkDisableConditionForQns(item)}">
                                                <app-tiny-mice (emitEditorValue)="cfsGetPara($event, i)"
                                                               [editorPatchValue]="item.given_answer[0].isSelected == '' ? false : item.given_answer[0].isSelected"
                                                               [height]="120"
                                                               [id]="i+'para'"
                                                               [readonly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                               [showDropBtn]="false"
                                                               [showInputBtn]="false"
                                                               class="mt-2">
                                                </app-tiny-mice>
                                            </div>

                                            <div class="mt-4 row" *ngIf="['55'].indexOf(item.question_type_id) > -1">
                                                <!--                                        <div class="pl-0 col-3" *ngIf="previousFeedBack.length != 0">-->
                                                <!--                                            <div class="col-12 sidebar-widget">-->
                                                <!--                                                <h5 class="font-weight-bold">Version History</h5>-->
                                                <!--                                                <ul class="widget-post pt-15">-->
                                                <!--                                                    <li (click)="feedbackSelected('current')" *ngIf="!feedbackServiceCalled" [ngClass]="{'active': selectedFeedBackIndex === ''}">-->
                                                <!--                                                        <a>Current Version</a>-->
                                                <!--                                                    </li>-->
                                                <!--                                                    <li *ngFor="let feedback of previousFeedBack; let i = index" [ngClass]="{'active': selectedFeedBackIndex === previousFeedBack.length - i}"-->
                                                <!--                                                        (click)="feedbackSelected(feedback)">-->
                                                <!--                                                        <a class="d-flex align-items-center justify-content-between">-->
                                                <!--                                                            <h5 class="mb-0 d-inline-flex" [ngClass]="{'color-primary': selectedFeedBackIndex === previousFeedBack.length - i}"-->
                                                <!--                                                                style="font-size: 14px">Version {{previousFeedBack.length - i}}-->
                                                <!--                                                                <span class="badge badge-info ml-2">{{feedback?.student_score}} / {{feedback?.total_score}}</span>-->
                                                <!--                                                            </h5>-->
                                                <!--                                                            <span class="badge" [ngClass]="{'badge-exceptional': getFeedbackLabel(feedback).label === 'Exceptional', 'badge-good': getFeedbackLabel(feedback).label === 'Good',-->
                                                <!--                                                                'badge-improve': getFeedbackLabel(feedback).label === 'Improve'}">{{getFeedbackLabel(feedback).label}}</span></a>-->
                                                <!--                                                    </li>-->
                                                <!--                                                </ul>-->
                                                <!--                                            </div>-->
                                                <!--                                            <div class="col-12 resource-link-card mt-3" *ngIf="previousFeedBack.length < maximumAllowedCount">-->
                                                <!--                                                <span class="text-info">You can use Request For Feedback<strong>&nbsp;{{maximumAllowedCount - previousFeedBack.length}}&nbsp;</strong>more times!</span>-->
                                                <!--                                            </div>-->
                                                <!--                                        </div>-->

                                                <div class="text-area col-12 {{isSingleQnsWithFeedbackType ? 'pl-4' : ''}}">
                                                    <div class="d-flex justify-content-between" id="essay_textarea">
                                                        <div class="col-6 px-0">
                                                            <h5 class="font-weight-bold">
                                                                <span *ngIf="reviseSelected != ''">Current Version</span>
                                                                <span *ngIf="reviseSelected == ''">Version {{selectedFeedBackIndex}}</span>
                                                            </h5>
                                                        </div>
                                                        <div class="col-6 px-0 mb-2" *ngIf="previousFeedBack.length != 0">
                                                            <label class="label_design">Select Version</label>
                                                            <ng-select
                                                                       [items]="previousFeedBack"
                                                                       bindLabel="version_name"
                                                                       bindValue="index"
                                                                       [clearable]="false"
                                                                       (change)="feedbackSelected($event)"
                                                                       [(ngModel)]="selectedVersion"
                                                                       placeholder="Please Select"
                                                            >
                                                                <ng-template ng-option-tmp let-feedback="item" let-index="index">
                                                                    <div class="d-flex align-items-center justify-content-between w-100">
                                                                        <div>
                                                                            <h5 class="mb-0 d-inline-flex" style="font-size: 14px"
                                                                                [ngClass]="{'color-primary': selectedFeedBackIndex === previousFeedBack.length - index}">
                                                                                Version {{ previousFeedBack.length - index }}
                                                                                <span class="badge badge-info ml-2" style="align-content: center; padding: 4px 8px">
                                                                        {{ feedback?.student_score }} / {{ feedback?.total_score }}
                                                                    </span>
                                                                            </h5>
                                                                        </div>
                                                                        <span class="badge" [ngClass]="{'badge-exceptional':
                                                                getFeedbackLabel(feedback).label === 'Exceptional','badge-good': getFeedbackLabel(feedback).label === 'Good',
                                                                'badge-improve': getFeedbackLabel(feedback).label === 'Improve'}">
                                                                {{ getFeedbackLabel(feedback).label }}</span>
                                                                    </div>
                                                                </ng-template>
                                                            </ng-select>
                                                        </div>
                                                    </div>
                                                    <textarea class="form-control" rows="{{previousFeedBack.length < maximumAllowedCount ? '24' : '21'}}"
                                                              [ngModel]="getEssayAnswer(item)"
                                                              (ngModelChange)="onEssayAnswerChange(item, $event)"
                                                              [readonly]="reviseSelected == '' || (getData.student_content_status != '1' && getData.student_content_status != '2')"
                                                              [ngModelOptions]="{standalone: true}" placeholder="Please enter your answer"></textarea>
                                                    <div class="word-count">
                                                        <span class="mr-2">{{wordCount(item)}}&nbsp;Words</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div *ngIf="item.question_type_id == 24" class="mt-{{item.subQuestions[0]?.question != '' ? '0' : '4'}}"
                                                 [ngClass]="{'div-disable': checkDisableConditionForQns(item)}">
                                                <div *ngFor="let sec of item.subQuestions; let j = index" class="mb-3">

                                                    <div *ngIf="sec.question_type_id == 1 || sec.question_type_id == 2"
                                                         [ngClass]="{'div-disable': checkDisableConditionForQns(item)}">
                                                        <div [ngClass]="{'math' : getData?.is_test == '1' && ['math', 'maths'].includes(getData?.subject.toLowerCase())
                                            , 'rw' : !(getData?.is_test == '1' && ['math', 'maths'].includes(getData?.subject.toLowerCase()))}" class="col-md-12 mb-2 px-2">
                                                            <div (click)="option.eliminated ? '' : cfsPassageMultiChoice(i, j, k, sec)" [ngClass]="{'student-selected' : option.isSelected == k.toString()}"
                                                                 *ngFor="let option of sec.given_answer; let k = index"
                                                                 class="{{option.eliminated ? '' : 'cursor'}} overflow-auto row my-3 mx-0 p-2"
                                                                 style="max-height: 20rem">
                                                                <button [ngClass]="{'disabled': option.eliminated}" class="btn-primary inner_button">{{((k+1) + 9).toString(36).toUpperCase()}}</button>
                                                                <div class="col-11 pr-0 d-flex align-self-center justify-content-between" style="overflow: hidden">
                                                            <span class="cfs" [ngClass]="{'eliminated-option': option.eliminated}">
                                                                <span [innerHTML]="option.options | sanitizeHtml" class="remove-margin-bottom"></span>
                                                            </span>
                                                                    <span class="pl-2 align-self-center cursor" (click)="toggleEliminator($event, sec, k)" *ngIf="['1', '2'].includes(getData.student_content_status) && !(k.toString() == option.isSelected)">
                                                                <i *ngIf="!option.eliminated" title="Strike out the option" class="eliminator fas fa-strikethrough"></i>
                                                                <i *ngIf="option.eliminated" title="Undo the strike out" class="fa fa-undo"></i>
                                                            </span>
                                                                </div>
                                                                <!--                                                        <div class="pl-2 align-self-center cursor" (click)="toggleEliminator($event, sec, k)" *ngIf="['1', '2'].includes(getData.student_content_status) && !(k.toString() == option.isSelected)">-->
                                                                <!--                                                            <i *ngIf="!option.eliminated" title="Strike out the option" class="eliminator fas fa-strikethrough"></i>-->
                                                                <!--                                                            <i *ngIf="option.eliminated" title="Undo the strike out" class="fa fa-undo"></i>-->
                                                                <!--                                                        </div>-->
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div *ngIf="sec.question_type_id == '5' || sec.question_type_id == '7'"
                                                         class="table-flexible">
                                                        <table [ngClass]="{'div-disable': getData.student_content_status != '1' && getData.student_content_status != '2'}"
                                                               class="table px-3 table-bordered text-center mt-3 mb-3">
                                                            <thead>
                                                            <tr>
                                                                <th>Questions</th>
                                                                <th *ngFor="let list of sec.answer; let l=index"
                                                                    [innerHTML]="list | sanitizeHtml"
                                                                    class="remove-margin-bottom"></th>
                                                            </tr>
                                                            </thead>
                                                            <tbody>
                                                            <tr *ngFor="let list of sec.given_answer; let k=index">
                                                                <td [innerHTML]="list.options" class="remove-margin-bottom"></td>
                                                                <td *ngFor="let ans of sec.answer; let l=index">
                                                                    <input (click)="cfsGetChooseTable(sec, j, k, l)"
                                                                           *ngIf="sec.question_type_id == '5'"
                                                                           [checked]="sec.given_answer[k].isSelected == '' ? false : sec.given_answer[k].isSelected == l.toString()"
                                                                           class="radio_animated" name="{{i}}choose{{k}}passas{{j}}"
                                                                           type="radio">
                                                                    <input (click)="cfsGetChooseTable(sec, j, k, l)"
                                                                           *ngIf="sec.question_type_id == '7'"
                                                                           [checked]="splitMultiChoose(sec.given_answer[k].isSelected, l)"
                                                                           type="checkbox">
                                                                </td>
                                                            </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                    <div *ngIf="sec.question_type_id == '10'">
                                                        <div *ngFor="let data of sec.given_answer;let k = index"
                                                             class="col-md-6 mt-3 mb-3 px-1">
                                                            <label>Input - {{k + 1}}</label>
                                                            <input (input)="cfsGetInput($event, j, k, sec)"
                                                                   *ngIf="sec.editor_type == 1" placeholder="Enter the answer"
                                                                   [readOnly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                                   [value]="data.isSelected" class="form-control" type="text">
                                                            <app-tiny-mice (emitEditorValue)="cfsGetInput($event, j, k, sec)"
                                                                           *ngIf="sec.editor_type != 1"
                                                                           [editorPatchValue]="data.isSelected == '' ? false : data.isSelected"
                                                                           [height]="120"
                                                                           [id]="j+'inputPass'+k+'ssa'+i"
                                                                           [readonly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                                           [showDropBtn]="false"
                                                                           [showInputBtn]="false"
                                                                           class="mt-2">
                                                            </app-tiny-mice>
                                                        </div>
                                                    </div>
                                                    <div *ngIf="sec.question_type_id == '20'" class="mt-3 mb-2">
                                                        <app-tiny-mice (emitEditorValue)="cfsGetPassageEssay($event, j, sec)"
                                                                       [editorPatchValue]="sec.given_answer[0]?.isSelected == '' ? false : sec.given_answer[0]?.isSelected"
                                                                       [height]="200"
                                                                       [id]="j+'essayPass'"
                                                                       [readonly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                                       [showDropBtn]="false"
                                                                       [showInputBtn]="false"
                                                                       class="mt-2">
                                                        </app-tiny-mice>
                                                    </div>
                                                </div>
                                            </div>

                                            <div *ngIf="item.question_type_id == 28" class="mt-4 px-3 mb-3">
                                                <app-tiny-mice (emitEditorValue)="cfsGetHighlight($event, i)"
                                                               [editorPatchValue]="item.given_answer[0]?.isSelected == '' ? item.options[0].options : item.given_answer[0]?.isSelected"
                                                               [height]="120"
                                                               [id]="i+'delta'"
                                                               [readonly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                               [showDropBtn]="false"
                                                               [showInputBtn]="false"
                                                               class="mt-2">
                                                </app-tiny-mice>
                                            </div>
                                            <div *ngIf="item.question_type_id == 40 || item.question_type_id == 41"
                                                 class="mt-4 mb-4">
                                                <div class="col-12 mt-0 d-flex justify-content-center">
                                                    <app-graph-component (valueChange)="cfsgetGraphValue($event, i)"
                                                                         [editMode]="getData.student_content_status == '1' || getData.student_content_status == '2'"
                                                                         [editPatchValue]="item.given_answer[0].correctAnswer ? parseVal(item.given_answer[0].correctAnswer) : false"
                                                                         [graphId]="'graphAnswering'+i"
                                                                         [questionType]="item.question_type_id"></app-graph-component>
                                                </div>
                                                <div class="col-md-12 mt-2">
                                                    <app-tiny-mice (emitEditorValue)="cfsGetGraghEditor($event, i)"
                                                                   [editorPatchValue]="item.student_editor_answer == '' ? false : item.student_editor_answer"
                                                                   [height]="120"
                                                                   [id]="i+'explaino'"
                                                                   [readonly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                                   [showDropBtn]="false"
                                                                   [showInputBtn]="false"
                                                                   class="mt-2">
                                                    </app-tiny-mice>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="card w-100 mt-2" *ngIf="((item.question_type_id != '24' && (item.is_correct == 'true' || item.is_correct == 'false')) ||
                                    (item.question_type_id == '24' && (item.subQuestions[0]?.is_correct == 'true' || item.subQuestions[0]?.is_correct == 'false'))) && getData?.is_test != '1'"
                                             style="border: 1px solid #e8eaed">
                                            <div class="card-body" [ngClass]="{'div-disable': checkDisableConditionForQns(item)}">

                                                <div class="col-md-12 px-0" *ngIf="item.question_type_id == 1 || item.question_type_id == 2">
                                                    <label class="mb-0"><strong>Correct Answer</strong></label>
                                                    <div [ngClass]="{'correct_ans-selected' : option.correctAnswer != ''}"
                                                         *ngFor="let option of item.answer; let k = index" style="max-height: 20rem"
                                                         class="{{option.correctAnswer != '' ? 'my-3 mx-2 p-2 cursor overflow-auto row' : ''}}">
                                                        <button *ngIf="option.correctAnswer != ''" class="btn-primary inner_button">{{((k+1) + 9).toString(36).toUpperCase()}}</button>
                                                        <div class="col-11 pt-1 pr-0 cfs" *ngIf="option.correctAnswer != ''">
                                                    <span [innerHTML]="item.options[k].options | sanitizeHtml"
                                                          class="remove-margin-bottom"></span>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-md-12 my-4 px-0 table-flexible" *ngIf="item.question_type_id == 5
                                            || item.question_type_id == 7">
                                                    <label><strong>Correct Answer</strong></label>
                                                    <table class="table table-bordered text-center div-disable">
                                                        <thead>
                                                        <tr>
                                                            <th>Questions</th>
                                                            <th *ngFor="let list of item.answer; let k=index"
                                                                [innerHTML]="list | sanitizeHtml" class="remove-margin-bottom"></th>
                                                        </tr>
                                                        </thead>
                                                        <tbody>
                                                        <tr *ngFor="let list of item.given_answer; let j=index">
                                                            <td [innerHTML]="list.options | sanitizeHtml"
                                                                class="remove-margin-bottom"></td>
                                                            <td *ngFor="let ans of item.answer; let k=index">
                                                                <input *ngIf="item.question_type_id == '5'"
                                                                       [checked]="item.heading_option[j].correctActive === k"
                                                                       class="radio_animated"
                                                                       name="{{i}}choosesingleCorrect{{j}}corect" type="radio">
                                                                <input *ngIf="item.question_type_id == '7'"
                                                                       [checked]="patchCorrectMultiChoiceAnswer(item.heading_option, k , j)"
                                                                       id="chooseMultipass{{i}}{{j}}{{k}}" type="checkbox">
                                                            </td>
                                                        </tr>
                                                        </tbody>
                                                    </table>
                                                </div>

                                                <div class="col-md-12 px-0" *ngIf="item.question_type_id == 9">
                                                    <label><b>Correct Answer</b></label>
                                                    <div *ngFor="let data of item.answer; let j = index" class="col-md-12 mt-2 mb-3">
                                                        <label>Dropdown - {{j + 1}}</label>
                                                        <div class="col-md-11">
                                                            <div class="col-md-12 bg-white innerhtml-margin-clear p-2 dropdown-border dropdown-toggle d-flex justify-content-between"
                                                                 data-toggle="dropdown" id="dropdown{{j}}"></div>
                                                            <div class="col-md-12 dropdown-menu">
                                                                <span class="dropdown-item dropdown-link overflow-auto">Select Answer</span>
                                                                <span *ngFor="let option of item.options; let k = index"
                                                                      [innerHTML]="option.listOption | sanitizeHtml"
                                                                      class="dropdown-item overflow-auto dropdown-link innerhtml-margin-clear"></span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-md-12 px-0" *ngIf="item.question_type_id == 10">
                                                    <label><b>Correct Answer</b></label>
                                                    <div *ngFor="let data of item.options; let j = index"
                                                         class="col-md-6 mt-3 mb-3">
                                                        <label>Input - {{j + 1}}</label>
                                                        <div class="form-span">
                                                            <div [innerHTML]="data.options[0].value | sanitizeHtml"></div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-md-12 px-0" *ngIf="item.question_type_id == 16">
                                                    <label><b>Correct Answer</b></label>
                                                    <div class="col-12">
                                                        <div *ngFor="let list of item.answer; let k=index"
                                                             class="input-group mb-3 mt-3 inputMenu">
                                                            <div cdkDrag class="input-group mb-1 inputMenu">
                                                                <div class="input-group-prepend">
                                                            <span class="input-group-text px-0 py-1">
                                                                <img class="img-fluid" src="assets/images/pdf-icons/equal@2x.png" alt="">
                                                            </span>
                                                                </div>
                                                                <h4 style="min-height: 46px" [innerHTML]="list.correctAnswer | sanitizeHtml"
                                                                    class="form-control mb-0 overflow-auto align-content-center"></h4>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-md-12 px-0" *ngIf="['20'].indexOf(item.question_type_id) > -1">
                                                    <label><b>Correct Answer</b></label>
                                                    <div *ngFor="let data of item.answer; let j = index"
                                                         class="col-md-6 mt-3 mb-3">
                                                        <label>Answer - {{j + 1}}</label>
                                                        <div class="form-span">
                                                            <div [innerHTML]="data.correctAnswer | sanitizeHtml"></div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div *ngIf="item.question_type_id == 24" class="col-md-12 px-0">
                                                    <div *ngFor="let sec of item.subQuestions; let j = index" class="mb-3">

                                                        <div class="col-md-12 px-0" *ngIf="sec.question_type_id == 1 || sec.question_type_id == 2">
                                                            <label class="mb-0"><strong>Correct Answer</strong></label>
                                                            <div [ngClass]="{'correct_ans-selected' : option.correctAnswer !== ''}"
                                                                 *ngFor="let option of sec.answer; let k = index"
                                                                 class="{{option.correctAnswer !== '' ? 'cursor overflow-auto row my-3 mx-0 p-2' : ''}}"
                                                                 style="max-height: 20rem">
                                                                <button *ngIf="option.correctAnswer != ''" class="btn-primary inner_button">{{((k+1) + 9).toString(36).toUpperCase()}}</button>
                                                                <div *ngIf="option.correctAnswer !== ''" class="col-11 pt-1 pr-0 cfs">
                                                            <span [innerHTML]="sec.options[k].options | sanitizeHtml"
                                                                  class="remove-margin-bottom"></span>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="col-md-12 px-0 py-2 table-flexible"
                                                             *ngIf="sec.question_type_id == '5' || sec.question_type_id == '7'">
                                                            <label><strong>Correct Answer :</strong></label>
                                                            <table class="table table-bordered text-center div-disable">
                                                                <thead>
                                                                <tr>
                                                                    <th>Questions</th>
                                                                    <th *ngFor="let list of sec.answer; let k=index"
                                                                        [innerHTML]="list | sanitizeHtml"
                                                                        class="remove-margin-bottom"></th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>
                                                                <tr *ngFor="let list of sec.given_answer; let j=index">
                                                                    <td [innerHTML]="list.options | sanitizeHtml"
                                                                        class="remove-margin-bottom"></td>
                                                                    <td *ngFor="let ans of sec.answer; let k=index">
                                                                        <input *ngIf="sec.question_type_id == '5'"
                                                                               [checked]="sec.heading_option[j].correctActive === k"
                                                                               class="radio_animated"
                                                                               name="{{i}}choosesingleCorrect{{j}}corect"
                                                                               type="radio">
                                                                        <input *ngIf="sec.question_type_id == '7'"
                                                                               [checked]="patchCorrectMultiChoiceAnswer(sec.heading_option, k , j)"
                                                                               id="chooseMultipass{{i}}{{j}}{{k}}" type="checkbox">
                                                                    </td>
                                                                </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>

                                                        <div class="col-md-12 px-0" *ngIf="sec.question_type_id == '10'">
                                                            <label><b>Correct Answer</b></label>
                                                            <div *ngFor="let data of sec.options; let j = index"
                                                                 class="col-md-6 mt-3 mb-3">
                                                                <label>Input - {{j + 1}}</label>
                                                                <div class="form-span">
                                                                    <div [innerHTML]="data.options[0].value | sanitizeHtml"></div>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="col-md-12 px-0" *ngIf="sec.question_type_id == '20'">
                                                            <label><b>Correct Answer</b></label>
                                                            <div *ngFor="let data of sec.answer; let j = index"
                                                                 class="col-md-12 mt-3 mb-3">
                                                                <label>Answer - {{j + 1}}</label>
                                                                <div class="form-span">
                                                                    <div [innerHTML]="data.correctAnswer | sanitizeHtml"></div>
                                                                </div>
                                                            </div>
                                                        </div>

                                                    </div>
                                                </div>

                                            </div>
                                        </div>

                                        <div class="mt-2" *ngIf="item.question_type_id != '24' && (item.is_correct == 'true' || item.is_correct == 'false') && getData?.is_test != '1'">
                                            <div class="col-md-12" *ngIf="item.explanation != ''">
                                                <label class="mb-0"><strong>Explanation</strong></label>
                                                <div class="col-12 mt-2 editor_bullet">
                                                    <span [innerHTML]="item.explanation | sanitizeHtml" class="remove-margin-bottom"></span>
                                                </div>
                                            </div>

                                            <div class="col-md-12 mt-3" *ngIf="item.resource != ''">
                                                <label class="mb-0"><strong>Resource</strong></label>
                                                <div class="col-12 mt-2 editor_bullet">
                                                    <span [innerHTML]="item.resource | sanitizeHtml" class="remove-margin-bottom"></span>
                                                </div>
                                            </div>
                                        </div>

                                        <div *ngIf="item.question_type_id == '24' && getData?.is_test != '1'">
                                            <div *ngFor="let sec of item.subQuestions; let j = index" class="mb-3">
                                                <div class="col-md-12" *ngIf="(sec.is_correct == 'true' || sec.is_correct == 'false') && sec.explanation != ''">
                                                    <label class="mb-0"><strong>Explanation</strong></label>
                                                    <div class="col-12 mt-2">
                                                        <span [innerHTML]="sec.explanation | sanitizeHtml" class="remove-margin-bottom"></span>
                                                    </div>
                                                </div>
                                                <div class="col-md-12 mt-3" *ngIf="(sec.is_correct == 'true' || sec.is_correct == 'false') && sec.resource != ''">
                                                    <label class="mb-0"><strong>Resource</strong></label>
                                                    <div class="col-12 mt-2">
                                                        <span [innerHTML]="sec.resource | sanitizeHtml" class="remove-margin-bottom"></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row {{item.question_type_id == '55' ? 'mt-3' : ''}}" *ngIf="(questionData.allow_workspace == '1' || questionData.allow_feedback == '1') && !isSingleQnsWithFeedbackType">
                                        <div class="col-md-12 {{item.question_type_id == '55' ? 'text-right pr-3' : 'px-0'}}">
                                            <button *ngIf="questionData.allow_workspace == '1'" (click)="item.workspaceClicked = !item.workspaceClicked;item.feedBackClicked = false"
                                                    class="btn cancel">{{isSingleQnsWithFeedbackType ? 'Cited Source' : 'WorkSpace'}}</button>
                                            <button *ngIf="questionData.allow_feedback == '1' && !isSingleQnsWithFeedbackType" (click)="item.feedBackClicked = !item.feedBackClicked;item.workspaceClicked = false"
                                                    class="btn cancel ml-2">FeedBack</button>
                                        </div>
                                    </div>

                                    <div class="row mt-4" *ngIf="isSingleQnsWithFeedbackType" [ngbCollapse]="!item.workspaceClicked">
                                        <div class="col-12 px-2">
                                            <div class="card">
                                                <div class="card-header p-3 background_gradient">
                                                    <h5 style="color: white;font-size: 16px" class="font-weight-bold">Cited Source</h5>
                                                </div>
                                                <div class="card-body custom_feedback_card_body p-3">
                                                    <div class="col-12 px-0">
                                                        <app-tiny-mice (emitEditorValue)="getWorkSpaceValue($event, i)"
                                                                       [editorPatchValue]="item.PatchData && item.question_type_id != '24' ? item.student_roughdata :
                                            item.PatchData && item.question_type_id == '24' ? item.subQuestions[0]?.student_roughdata :false"
                                                                       [height]="140"
                                                                       [readonly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                                       [showDropBtn]="false"
                                                                       [showInputBtn]="false">
                                                        </app-tiny-mice>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mt-3" *ngIf="!isSingleQnsWithFeedbackType" [ngbCollapse]="!item.workspaceClicked">
                                        <label><strong>WorkSpace:</strong></label>
                                        <div class="col-12 px-0">
                                            <app-tiny-mice (emitEditorValue)="getWorkSpaceValue($event, i)"
                                                           [editorPatchValue]="item.PatchData && item.question_type_id != '24' ? item.student_roughdata :
                                            item.PatchData && item.question_type_id == '24' ? item.subQuestions[0]?.student_roughdata :false"
                                                           [height]="140"
                                                           [readonly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                                           [showDropBtn]="false"
                                                           [showInputBtn]="false">
                                            </app-tiny-mice>
                                        </div>
                                    </div>

                                    <div class="mt-3" *ngIf="!isSingleQnsWithFeedbackType" [ngbCollapse]="!item.feedBackClicked">
                                        <div class="row">
                                            <label><strong>FeedBack :</strong></label>
                                            <div class="col-12 px-0">
                                <textarea (input)="getQueries($event, i, 0, 'scratch')"
                                          [readOnly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                          [value]="item.question_type_id != '24' ? item.student_feedback : item.subQuestions[0]?.student_feedback"
                                          class="form-control" cols="30" placeholder="Please Enter the Feedback"
                                          rows="3"></textarea>
                                            </div>
                                        </div>

                                        <div class="row mt-3" *ngIf="queries != '' && queriesIndex == 'id'+i">
                                            <div class="col-md-12">
                                                <button (click)="submitQueries(i, 0, 'scratch')"
                                                        class="pull-right btn btn-primary {{env.deviceType() ? 'border-radius-5' : ''}}">
                                                    Save
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mt-3" *ngIf="feedbackListData.length != 0 && isSingleQnsWithFeedbackType">
                                    <div class="col-12">
                                        <div class="card-header p-3 background_gradient">
                                            <h5 style="color: white">Overall FeedBack</h5>
                                        </div>
                                        <div class="card-body py-3 px-4 custom_feedback_card_body">
                                            <div class="row px-2" *ngFor="let data of feedbackListData; let last = last">
                                                <div class="col-12 card class-card1 py-2 {{last ? 'mb-0' : 'mb-3'}}">
                                                    <h5 class="color-primary">{{data.feedback}}</h5>
                                                    <p style="font-size: 12px" class="text-dark"><span *ngIf="data.version != ''"><strong>Version {{data.version}}</strong> - </span>
                                                        <span *ngIf="data.created_date != ''">{{data.created_date | date:'medium'}}</span></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="row mt-3" *ngIf="feedbackListData.length != 0 && !isSingleQnsWithFeedbackType">
                    <div class="col-12">
                        <div class="card p-3">
                            <div class="card-header p-3 background_gradient">
                                <h5 style="color: white">Overall FeedBack</h5>
                            </div>
                            <div class="card-body py-3 px-4 custom_feedback_card_body">
                                <div class="row px-2" *ngFor="let data of feedbackListData; let last = last">
                                    <div class="col-12 card class-card1 py-2 {{last ? 'mb-0' : 'mb-3'}}">
                                        <h5 class="color-primary">{{data.feedback}}</h5>
                                        <p style="font-size: 12px" class="text-dark"><span *ngIf="data.version != ''"><strong>Version {{data.version}}</strong> - </span>
                                            <span *ngIf="data.created_date != ''">{{data.created_date | date:'medium'}}</span></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-12 px-0" *ngIf="feedbackExpanded">
                    <ng-container *ngTemplateOutlet="feedback_data"></ng-container>
                </div>

            </div>

            <div #footer class="row mt-2" *ngIf="(totalAns.length != 0 && !isSingleQnsWithFeedbackType) ||
            (totalAns.length != 0 && (getData.student_content_status == '1' || getData.student_content_status == '2') && isSingleQnsWithFeedbackType)">
                <div class="col-12">
                    <div class="card">
                        <div class="row align-items-center">
                            <div class="col-12">
                                <div class="card-body {{env.deviceType() ? 'px-3 py-2' : ''}}">
                                    <div class="row my-1 d-flex align-items-center justify-content-between
                                    {{isSingleQnsWithFeedbackType && previousFeedBack.length != 0 ? '' : 'pr-3'}}">
                                        <div class="col-4" *ngIf="!(isSingleQnsWithFeedbackType && previousFeedBack.length != 0)">
                                            <div class="logo-wrapper d-flex justify-content-center">
                                                <img alt="" class="blur-up lazyloaded" src="assets/images/EdQuill.png" style="visibility:hidden;width: auto; height: 34px;">
                                            </div>
                                        </div>
                                        <div class="col-4" *ngIf="!isSingleQnsWithFeedbackType">
                                            <div class="text-center position-relative" #jumpWrapper>
                                                <button class="btn btn-primary" (click)="showJumpQuestion = !showJumpQuestion">
                                                    Questions
                                                </button>

                                                <div class="jump-question-box" *ngIf="showJumpQuestion">
                                                    <div class="box-title">Questions:</div>
                                                    <div class="col-12 px-0" style="margin-bottom: 10px">
                                                        <span><i style="font-size: 16px;" class="fa fa-bookmark-o"></i><span style="font-size: 13px;color: #777">  - Not Answered</span></span>
                                                        <span class="ml-3"><i style="border-bottom: 0 !important;font-size: 16px;" class="fa fa-bookmark-o bg-partially"></i><span style="font-size: 13px;color: #777">  - Answered</span></span>
                                                        <span class="ml-3"><i style="border-bottom: 0 !important;font-size: 16px;" class="fa fa-bookmark-o color-primary"></i><span style="font-size: 13px;color: #777">  - Current Question</span></span>
                                                        <span class="ml-3"><img style="width: 16px" alt="Review Marked" src="assets/images/bookmark_checked.webp"><span style="font-size: 13px;color: #777"> - For Review</span></span>
                                                    </div>
                                                    <div class="question-grid">
                                                        <ng-container *ngFor="let list of totalAns; let i = index">
                                                            <ng-container *ngTemplateOutlet="questionButton; context: { $implicit: list, index: i }"></ng-container>
                                                        </ng-container>
                                                        <!--                                                <button class="d-flex align-items-center justify-content-around" (click)="modalRef?.close();showJumpQuestion = false;checkWhetherSaveIsNeeded(list, i, 'qnsNumber')" *ngFor="let list of totalAns; let i = index"-->
                                                        <!--                                                        [ngClass]="{'bg-green':checkQuestionId(list)?.is_correct == 'true', 'bg-partially': checkQuestionId(list)?.is_correct == 'partially-completed' || checkQuestionId(list)?.is_correct == 'manual',-->
                                                        <!--                                                    'bg-red':checkQuestionId(list)?.is_correct == 'false', active: showQuestion === i }"-->
                                                        <!--                                                >-->
                                                        <!--                                                    <i *ngIf="!list.markedAsReview" title="Review"-->
                                                        <!--                                                       style="font-size: 16px;" class="fa fa-bookmark-o cursor"></i>-->
                                                        <!--                                                    <img *ngIf="list.markedAsReview && !(checkQuestionId(list)?.is_correct == 'partially-completed' || checkQuestionId(list)?.is_correct == 'manual')" title="Marked For Review"-->
                                                        <!--                                                         style="width: 16px" class="cursor" alt="Review Marked" src="assets/images/bookmark_checked.webp">-->
                                                        <!--                                                    <img *ngIf="list.markedAsReview && (checkQuestionId(list)?.is_correct == 'partially-completed' || checkQuestionId(list)?.is_correct == 'manual')" title="Marked For Review"-->
                                                        <!--                                                         style="width: 16px" class="cursor" alt="Review Marked" src="assets/images/bookmark_checked_yellow.png">-->
                                                        <!--                                                    <span class="ml-1">{{ i + 1 }}</span>-->
                                                        <!--                                                </button>-->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-4" *ngIf="!isSingleQnsWithFeedbackType">
                                            <button *ngIf="(totalAns.length != showQuestion + 1)" class="btn pull-right btn-primary ml-2" (click)="checkLastQuestion(showQuestion, showQuestion == totalAns.length)">
                                                Next</button>
                                            <button *ngIf="(totalAns.length == showQuestion + 1) && (getData.student_content_status == '1' || getData.student_content_status == '2')"
                                                    class="btn pull-right btn-primary ml-2" (click)="checkSubmitFunction()">Submit</button>
                                            <button *ngIf="showQuestion != 0" class="btn pull-right cancel" (click)="previousQuestion()">
                                                Previous</button>
                                            <button class="btn pull-right btn-outline-primary mr-2" (click)="tryAgainButton()"
                                                    *ngIf="checkQuestionId(totalAns[showQuestion])?.is_correct == 'partially-completed' && !tryAgainButtonEnabled">
                                                Try Again <i class="fa fa-repeat ml-1" aria-hidden="true"></i></button>
                                        </div>

                                        <div class="col-{{isSingleQnsWithFeedbackType && previousFeedBack.length != 0 ? '12' : '8'}}" *ngIf="(getData.student_content_status == '1' || getData.student_content_status == '2') && isSingleQnsWithFeedbackType">
                                            <div>
                                                <button *ngIf="(questionData?.auto_review != '0' && reviseSelected == '') || questionData?.auto_review == '0'"
                                                        class="btn btn-primary ml-3 pull-right" (click)="checkForApiTypeQns()">Submit For Final</button>

                                                <button *ngIf="questionData?.auto_review != '0' && previousFeedBack.length != 0 && reviseSelected != ''"
                                                        class="btn btn-primary ml-3 pull-right" (click)="undoRevise(previousFeedBack[0])">
                                                    <i class="fa fa-undo mr-1" aria-hidden="true"></i>Undo Revise</button>

                                                <button class="btn pull-right btn-outline-primary ml-3" (click)="overAllStartTimer();feedbackSelected('current')"
                                                        *ngIf="previousFeedBack.length <= 9 && reviseSelected == ''">
                                                    <i class="fa fa-repeat mr-1" aria-hidden="true"></i>Revise</button>

                                                <button *ngIf="previousFeedBack.length < maximumAllowedCount && questionData?.auto_review != '0' && reviseSelected != ''"
                                                        (click)="getFeedbackValue(totalAns[showQuestion])" class="btn btn-outline-primary pull-right ml-3">
                                                    <i class="fa fa-comments mr-1" aria-hidden="true"></i>Request For Feedback ({{previousFeedBack.length}} / {{maximumAllowedCount}})
                                                </button>

                                                <div class="btn-group dropup pull-right" *ngIf="(getData.student_content_status == '1' || getData.student_content_status == '2') && isSingleQnsWithFeedbackType">
                                                    <button data-toggle="dropdown" class="btn btn-outline-primary" style="border-radius: 5px;">Save<i
                                                            class="fa fa-sort-desc float-right ml-2" aria-hidden="true"></i>
                                                    </button>
                                                    <div class="dropdown-menu">
                                                        <a class="dropdown-item dropdown-link" (click)="saveAnswer('2', 'noExit', true, 'same')"><i class="fa fa-floppy-o mr-1" aria-hidden="true"></i>Save</a>
                                                        <a class="dropdown-item dropdown-link" (click)="saveAnswer('2', 'exit', true, 'same')"><i class="fa fa-sign-out mr-1" aria-hidden="true"></i>Save
                                                            & Exit</a>
                                                    </div>
                                                </div>

                                                <button *ngIf="(getData.student_content_status == '1' || getData.student_content_status == '2') && !isSingleQnsWithFeedbackType"
                                                        class="btn pull-right btn-outline-primary ml-3" (click)="saveAnswer('2', 'noExit', true, 'same')">
                                                    <i class="fa fa-floppy-o mr-1" aria-hidden="true"></i>Save</button>

                                                <button *ngIf="(getData.student_content_status == '1' || getData.student_content_status == '2') && !isSingleQnsWithFeedbackType"
                                                        class="btn pull-right btn-outline-primary" (click)="saveAnswer('2', 'exit', true, 'same')">
                                                    <i class="fa fa-sign-out mr-1" aria-hidden="true"></i>Save & Exit</button>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div [ngStyle]="{ 'max-height': totalFeedbackMaxHeight}" class="content-card col-6 2"
             *ngIf="isSingleQnsWithFeedbackType && previousFeedBack.length != 0 && !feedbackExpanded && isOpen">
            <ng-container *ngTemplateOutlet="feedback_data"></ng-container>
        </div>

        <div [ngStyle]="{ 'max-height': totalFeedbackMaxHeight}" class="content-card col-6 1"
             *ngIf="isSingleQnsWithFeedbackType && previousFeedBack.length != 0 && !feedbackExpanded && !isOpen">
            <ng-container *ngTemplateOutlet="feedback_data"></ng-container>
        </div>
    </section>

</div>

<ng-template #submitAlert let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h4 class="modal-title letter">Submit {{contentType}}</h4>
    </div>
    <div class="modal-body p-0">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <p style="color: #313131" class="mb-0 my-3 font-weight-bold" *ngIf="buttonClicked == 'submit'">Once submitted, you will not be able to edit your answers</p>
                    <p style="color: #313131" class="mb-0 my-3 font-weight-bold" *ngIf="buttonClicked == ''">Yay! Your final effort and last question are here. The subsequent
                        assignment will be turned in for evaluation after clicking the OK button</p>
                </div>

                <div class="col-12 mb-3" *ngIf="!showpdf && !isSingleQnsWithFeedbackType">
                    <textarea [(ngModel)]="totalFeedBack" class="form-control"
                              [readOnly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                              placeholder="Please Enter the Overall Feedback" cols="30" rows="3"></textarea>
                </div>

                <div class="col-12" style="margin-bottom: 10px" *ngIf="!showpdf && totalAns.length > 1">
                    <span><i style="font-size: 16px;" class="fa fa-bookmark-o"></i><span style="font-size: 13px;color: #777">  - Not Answered</span></span>
                    <span class="ml-3"><i style="border-bottom: 0 !important;font-size: 16px;" class="fa fa-bookmark-o bg-partially"></i><span style="font-size: 13px;color: #777">  - Answered</span></span>
                    <span class="ml-3"><i style="border-bottom: 0 !important;font-size: 16px;" class="fa fa-bookmark-o color-primary"></i><span style="font-size: 13px;color: #777">  - Current Question</span></span>
                    <span class="ml-3"><img style="width: 16px" alt="Review Marked" src="assets/images/bookmark_checked.webp"><span style="font-size: 13px;color: #777"> - For Review</span></span>
                </div>

                <div class="col-12 mb-3" *ngIf="!showpdf && totalAns.length > 1">
                    <div class="box-title">Questions</div>
                    <div class="question-grid-submit">
                        <ng-container *ngFor="let list of totalAns; let i = index">
                            <ng-container *ngTemplateOutlet="questionButton; context: { $implicit: list, index: i }"></ng-container>
                        </ng-container>
                    </div>
                </div>

            </div>
            <!-- Container-fluid Ends-->
        </div>
        <div class="modal-footer d-flex justify-content-right">
            <button (click)="buttonClicked = '';close()"
                    class="btn cancel {{env.deviceType() ? 'border-radius-5' : ''}}" type="button">Cancel
            </button>
            <button [disabled]="disableButton" *ngIf="isSingleQnsWithFeedbackType && questionData?.auto_review != '0'" (click)="disableButton = true;timeIntervalRunningForTest = false;submitAnswering = true;getFeedbackValue(this.totalAns[0], 'saveAndExit');"
                    class="btn btn-primary {{env.deviceType() ? 'border-radius-5' : ''}}" type="button">Ok
            </button>
            <button [disabled]="disableButton" *ngIf="!(isSingleQnsWithFeedbackType && questionData?.auto_review != '0')" (click)="disableButton = true;buttonClicked = '';submitAnswering = true;
                            timeIntervalRunningForTest = false;saveAnswer('4', 'exit', true)"
                    class="btn btn-primary {{env.deviceType() ? 'border-radius-5' : ''}}" type="button">Ok
            </button>
        </div>
    </div>
</ng-template>

<ng-template #reviewAlert let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h4 class="modal-title letter">Review Confirmation</h4>
    </div>
    <div class="modal-body p-0">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <p style="color: #313131" class="mb-0 my-3 font-weight-bold">Some of the questions are marked for review. Would you like to proceed further?</p>
                </div>
            </div>
            <!-- Container-fluid Ends-->
        </div>
        <div class="modal-footer d-flex justify-content-right">
            <button (click)="close()" class="btn cancel {{env.deviceType() ? 'border-radius-5' : ''}}" type="button">Cancel</button>
            <button (click)="modalRef.close();buttonClicked = 'submit';submitPopup()" class="btn btn-primary {{env.deviceType() ? 'border-radius-5' : ''}}" type="button">Ok</button>
        </div>
    </div>
</ng-template>

<ng-template #answerGraph let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h4 class="modal-title letter">Answer graph</h4>
    </div>
    <div class="modal-body">

        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12 mt-4 px-0">
                    <div class="col-md-12">
                        <app-graph-component (valueChange)="storeGraph($event)"
                                             [editMode]="getData.student_content_status == '1' || getData.student_content_status == '2'"
                                             [editPatchValue]="graphAnswerVal == '' ? false : parseVal(graphAnswerVal)"
                                             [graphId]="'deaaa'"
                                             [questionType]="'40'"></app-graph-component>
                        <!--                        <app-graph-component [editMode]="false"-->
                        <!--                                             [editPatchValue]="false"-->
                        <!--                                             [graphId]="'previewG'"-->
                        <!--                                             [questionType]="'40'"></app-graph-component>-->
                    </div>
                </div>
            </div>
            <div class="row mt-3 d-flex">
                <div class="col-md-12">
                    <button [attr.aria-controls]="'#queries' + graphIndex" [attr.data-target]="'#queries' + graphIndex"
                            [disabled]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                            aria-expanded="false" class="btn-sm btn-outline-primary mr-2" data-toggle="collapse">
                        Feedback
                    </button>
                    <button [attr.aria-controls]="'#workspace' + graphIndex"
                            [attr.data-target]="'#workspace' + graphIndex" aria-expanded="false"
                            class="btn-sm btn-outline-primary mr-2" data-toggle="collapse">work space
                    </button>
                    <button (click)="openWorkArea('', graphId, graphIndex)" class="btn-sm mb-1 btn-outline-primary mr-2"
                            title="Work Area">Work area
                    </button>
                    <button [attr.aria-controls]="'#answer'" [attr.data-target]="'#answer'" aria-expanded="false"
                            class="btn-sm btn-outline-primary mr-2" data-toggle="collapse">Set Answer
                    </button>
                </div>
            </div>
            <div class="row mt-3 mb-3">
                <div class="col-md-12 collapse" id="queries{{graphIndex}}">
                    <textarea (input)="getQueries($event, graphId, graphIndex, 'pdf')" [value]="graphFeedback"
                              class="form-control" placeholder="Feedback" rows="3"></textarea>
                </div>
            </div>
            <div class="row mt-3 d-flex">
                <div class="col-md-12">
                    <button (click)="submitQueries(graphId, graphIndex, 'pdf')"
                            *ngIf="queries != '' && queriesIndex == graphIndex+'id'+graphId"
                            class="btn-sm btn-primary mr-2">Submit
                    </button>
                </div>
            </div>
            <div class="row mt-3 mb-3">
                <div class="col-md-12 collapse" id="workspace{{graphIndex}}">
                    <app-tiny-mice (emitEditorValue)="getNumericWorkSpaceValue($event, graphId, graphIndex)"
                                   [editorPatchValue]="this.workspacedata[graphId].section[graphIndex].patchData == false ? false : this.totalAns[graphId].section[graphIndex].student_roughdata"
                                   [height]="250"
                                   [readOnly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                   [id]="'workspacing'"
                                   [showDropBtn]="false"
                                   [showInputBtn]="false">
                    </app-tiny-mice>
                </div>
                <div #answer class="col-md-12 collapse" id="answer">
                    <app-tiny-mice (emitEditorValue)="getGraphEditorValue($event)"
                                   [editorPatchValue]="this.graphEditorAnsDup == false ? false : this.graphEditorAns"
                                   [height]="250"
                                   [id]="'answerrr'"
                                   [readonly]="false"
                                   [showDropBtn]="false"
                                   [showInputBtn]="false"
                    >
                    </app-tiny-mice>
                </div>
            </div>
            <!-- Container-fluid Ends-->
        </div>
        <div class="modal-footer d-flex justify-content-right mt-2">
            <button (click)="closeGraph(graphId, graphIndex)"
                    class="btn btn-primary-outline {{env.deviceType() ? 'border-radius-5' : ''}}" type="button">Cancel
            </button>
            <button (click)="getGraphAnswerValue(getGraph, graphId, graphIndex)"
                    class="btn btn-primary {{env.deviceType() ? 'border-radius-5' : ''}}" type="button">Submit
            </button>
        </div>
    </div>
</ng-template>

<ng-template #content let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h4 class="modal-title font-weight-bold" id="modal-basic-title">Resources</h4>
    </div>
    <div class="modal-body">
        <!-- Container-fluid starts-->
        <div class="container-fluid">
            <div class="row" *ngFor="let item of linkdata; let j = index">
                <div class="col-md-12">
                    <a class="cursor" href="{{item.link}}" target="_blank">
                        <span style="overflow: scroll; overflow-y: hidden"
                              title="{{item.link}}">{{item.name != '' ? item.name : item.link}}</span>
                    </a>
                    <hr *ngIf="j != linkdata.length - 1">
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-primary {{env.deviceType() ? 'border-radius-5' : ''}}" (click)="onSave()">
            Cancel
        </button>
    </div>
</ng-template>

<ng-template #showExpand let-c="close" let-d="dismiss">

    <div class="modal-body" style="border: 0;">
        <div class="container-fluid">
            <div class="row">
                <!--                <div class="col-sm-12 text-right">-->
                <!--                    <i (click)="close()" class="fa fa-close cursor" style="font-size: 1rem"></i>-->
                <!--                </div>-->
                <div class="row d-flex justify-content-between">
                    <div class="col-md-1 mt-2">
                        <button class="btn btn-primary {{env.deviceType() ? 'border-radius-5' : ''}}">{{showAnswerItem.sub_question_no}}</button>
                    </div>
                </div>
                <div class="col-11 mt-2">
                    <div *ngIf="showAnswerItem.question != ''" [innerHTML]="showAnswerItem.question | sanitizeHtml"
                         class="mb-0 overflow-auto div-disable"></div>
                </div>
                <div class="col-12 mt-2 text-center" *ngIf="showAnswerItem.question_type_id == '30'">
                    <app-tiny-mice class="mt-2"
                                   (emitEditorValue)="getNumericAnswerValue1($event, showAnswerI, showAnswerJ)"
                                   [editorPatchValue]="showAnswerItem.given_answer == '' ? false : showAnswerItem.given_answer1"
                                   [readonly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                                   [height]="250"
                                   [id]="showAnswerI+'giveAnsPop'+showAnswerJ"
                                   [showDropBtn]="false"
                                   [showInputBtn]="false">
                    </app-tiny-mice>
                    <button (click)="patchMinimize(showAnswerI, showAnswerJ, showAnswerItem)"
                            class="btn-sm mb-1 btn-outline-primary mr-2 mt-3">Show minimize Editor
                    </button>
                </div>
                <div class="col-12 mt-2 text-center" *ngIf="showAnswerItem.question_type_id == '20'">
                    <textarea (input)="getInputAns($event, showAnswerI, showAnswerJ)"
                              [readOnly]="getData.student_content_status != '1' && getData.student_content_status != '2'"
                              class="form-control" cols="30" rows="8">{{showAnswerItem.given_answer}}</textarea>
                    <button (click)="patchMinimize(showAnswerI, showAnswerJ, showAnswerItem)"
                            class="btn-sm mb-1 btn-outline-primary mr-2 mt-3">Show minimize Editor
                    </button>
                </div>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #feedback let-c="close" let-d="dismiss">
    <div class="modal-header d-flex justify-content-between">
        <h4 class="mb-0" style="color: #8F008A">Overall Feedback</h4><i (click)="close()"
                                                                        class="fa fa-times-circle cursor"
                                                                        style="font-size: 1.2rem"></i>
    </div>
    <div class="modal-body">
        <div class="container-fluid">
            <div class="col-md-12 d-flex mt-4 mb-4 p-4 release-card">
                <span>{{questionData.teacher_feedback}}</span>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #workArea let-c="close" let-d="dismiss">
    <div class="modal-header d-flex justify-content-between">
        <h4 class="mb-0">Work Area</h4><i (click)="closeWorkArea()" class="fa fa-times-circle cursor"
                                          style="font-size: 1.2rem"></i>
    </div>
    <div class="modal-body" style="border: 0">
        <div class="container-fluid">
            <div *ngIf="(getData.student_content_status == '1' || getData.student_content_status == '2') && !env.deviceType()">
                <app-annotation (annotate)="getWorkAreaAnnotation($event)"
                                [getAnnotate]="workAnnotate"
                                [id]="'workArea'"
                                [toolAdjust]="true"
                                [toolHide]="true"
                                [userType]="'student'"></app-annotation>
            </div>
            <div *ngIf="(getData.student_content_status == '1' || getData.student_content_status == '2') && env.deviceType()">
                <app-student-web-annotation
                        (annotate)="getWorkAreaAnnotation($event)"
                        [getAnnotate]="workAnnotate"
                        [toolAdjust]="true"
                        [toolHide]="true"
                        [popUp]="true"
                ></app-student-web-annotation>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #feedbackStatus>
    <div class="modal-body">
        <div class="col-12 px-0 my-3 d-flex flex-row align-items-center">
            <div class="feedback_spinner"></div>
            <span class="ml-3" style="font-size: 16px">{{popUpMessage}}</span>
        </div>
    </div>
</ng-template>

<ng-template #durationWarning let-c="close" let-d="dismiss">
    <div class="modal-header">
        <h4 class="modal-title letter">{{firstWarning ? 'Remaining Duration' : 'Duration Completed'}}</h4>
    </div>
    <div class="modal-body p-0">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <p *ngIf="firstWarning" style="color: #313131; font-size: 14px" class="mb-0 my-3">You now have <span class="font-weight-bold"> 5 minutes</span> left to complete the test.
                        Please make sure your responses are saved and ready forÂ submission.</p>
                    <p *ngIf="!firstWarning" style="color: #313131; font-size: 14px" class="mb-0 my-3 font-weight-bold">Test time is now complete.
                        All your answers will be saved and submitted automatically.</p>
                </div>
            </div>
        </div>
        <div class="modal-footer d-flex justify-content-right">
            <button [disabled]="disableDurationWarningButton" *ngIf="isSingleQnsWithFeedbackType && questionData?.auto_review != '0'" (click)="disableDurationWarningButton = true; firstWarning ? closeAndStartTimer() : getFeedbackValue(this.totalAns[0], 'saveAndExit');"
                    class="btn btn-primary {{env.deviceType() ? 'border-radius-5' : ''}}" type="button">Ok
            </button>
            <button [disabled]="disableDurationWarningButton" *ngIf="!(isSingleQnsWithFeedbackType && questionData?.auto_review != '0')" (click)="disableDurationWarningButton = true; checkFinalSave()"
                    class="btn btn-primary {{env.deviceType() ? 'border-radius-5' : ''}}" type="button">Ok
            </button>
        </div>
    </div>
</ng-template>

<ng-template #testTimerStatus>
    <div class="modal-header d-flex justify-content-between">
        <h4 class="mb-0 font-weight-bold color-primary">Take A Break!</h4>
    </div>
    <div class="modal-body">
        <div class="col-12 px-0 text-center">
            <img src="assets/images/take-a_break.png" alt="Take a break" class="w-100">
            <div class="col-12 col-12 d-flex flex-row align-items-center justify-content-center">
                <div class="timer_button p-2 row">
                    <div class="w-auto text-center">
                        <h4 style="font-size: 24px" class="mb-0"><b>{{testElapsedTime?.minutes}}</b></h4>
                        <span style="font-size: 12px"  class="color-primary mb-0">Minutes</span>
                    </div>
                    <div class="w-auto mx-2" style="margin-top: 2px">
                        <h4 class="mb-0 font-weight-bold">:</h4>
                    </div>
                    <div class="w-auto text-center">
                        <h4 style="font-size: 24px" class="mb-0"><b>{{testElapsedTime?.seconds}}</b></h4>
                        <span style="font-size: 12px"  class="color-primary mb-0">Seconds</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer py-2 justify-content-between">
        <h6 class="m-0">Click on the skip button to resume</h6>
        <button [disabled]="disableSkipButton" class="btn btn-primary" (click)="disableSkipButton = true; timeTakenForTestInterval = 0;pauseTimerIntervalOfTest();skipToNextContent()">Skip</button>
    </div>
</ng-template>

<ng-template #questionButton let-list let-i="index">
    <button (click)="modalRef?.close();showJumpQuestion = false;checkWhetherSaveIsNeeded(list, i, 'qnsNumber')"
            class="d-flex align-items-center justify-content-around"  [ngClass]="getButtonClass(list, i)">

        <ng-container *ngIf="!list.markedAsReview">
            <i title="Review" class="fa fa-bookmark-o cursor" style="font-size: 16px;"></i>
        </ng-container>

        <ng-container *ngIf="list.markedAsReview">
            <img [src]="getReviewIcon(checkQuestionId(list)?.is_correct)" [title]="'Marked For Review'" class="cursor"
                 style="width: 16px" alt="Review Marked">
        </ng-container>

        <span class="ml-1">{{ i + 1 }}</span>
    </button>
</ng-template>

<ng-template #feedback_data let-row>
    <h4 class="font-weight-bold mt-2 mb-3">Feedback <span *ngIf="reviseSelected == 'current'">{{previousFeedBack.length}}</span>
        <span *ngIf="reviseSelected != 'current'">{{selectedFeedBackIndex}}</span>
        <span *ngIf="selectedPreviousStudentAnswer?.created_date"> ({{selectedPreviousStudentAnswer?.created_date | customDateFormat}}  | {{selectedPreviousStudentAnswer?.created_date | date:'h:mm a'}}) </span>:</h4>
    <div class="col-12 px-0" *ngIf="selectedPreviousStudentAnswer?.version != 'V1'">
        <div class="card">
            <div class="card-header p-3 background_gradient">
                <h5 style="color: white;font-size: 16px" class="font-weight-bold">Score Chart</h5>
            </div>
            <div class="card-body custom_feedback_card_body p-3">
                <div class="row justify-content-center flex-column">
                    <div class="col-12 d-flex justify-content-center">
                        <div class="text-center">
                            <h5 class="font-weight-bold">Feedback Score</h5>
                            <p style="font-size: 14px" class="mb-0">
                                                    <span>Current Version : <span style="color: #008ffb" class="font-weight-bold">
                                                {{selectedPreviousStudentAnswer?.student_score}} / {{selectedPreviousStudentAnswer?.total_score}}</span></span>
                                <span class="ml-2">Previous Version :
                                            <span style="color: #00e396" *ngIf="selectedFeedBackIndex != 1 && selectedFeedBackIndex != '' && !feedbackServiceCalled" class="font-weight-bold">
                                                {{previousFeedBack[selectedPreviousStudentAnswer?.index + 1]?.student_score}} / {{previousFeedBack[selectedPreviousStudentAnswer?.index + 1]?.total_score}}
                                            </span>
                                            <span style="color: #00e396" *ngIf="selectedFeedBackIndex != 1 && selectedFeedBackIndex != '' && feedbackServiceCalled" class="font-weight-bold">
                                              {{previousFeedBack[1]?.student_score}} / {{previousFeedBack[1]?.total_score}}
                                            </span>
                                            <span *ngIf="selectedFeedBackIndex == 1"> - </span></span>
                            </p>
                        </div>
                    </div>

                    <div class="col-12">
                        <div id="chart2">
                            <apx-chart
                                    [series]="chartOptions?.series"
                                    [chart]="chartOptions?.chart"
                                    [xaxis]="chartOptions?.xaxis"
                                    [yaxis]="chartOptions?.yaxis"
                                    [plotOptions]="chartOptions?.plotOptions"
                                    [dataLabels]="chartOptions?.dataLabels"
                                    [legend]="chartOptions?.legend">
                            </apx-chart>
                        </div>
                    </div>

                    <div class="col-12 mt-2" *ngIf="selectedPreviousStudentAnswer.strengths">
                        <div *ngIf="selectedPreviousStudentAnswer.strengths.length != 0">
                            <label class="font-weight-bold">Strengths: </label>
                            <h5 class="strength_text" *ngFor="let value of selectedPreviousStudentAnswer.strengths">{{value}}</h5>
                        </div>
                    </div>

                    <div class="col-12 mt-3" *ngIf="selectedPreviousStudentAnswer.top_opportunities">
                        <div *ngIf="selectedPreviousStudentAnswer.top_opportunities.length != 0">
                            <label class="font-weight-bold">Top Opportunities: </label>
                            <h5 class="top_opportunity_text" *ngFor="let value of selectedPreviousStudentAnswer.top_opportunities">{{value}}</h5>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-12 mt-3 px-0">
        <div class="card">
            <div class="card-header p-3 background_gradient">
                <h5 style="color: white;font-size: 16px" class="font-weight-bold">Trait Analysis</h5>
            </div>
            <div class="card-body custom_feedback_card_body p-3">
                <div style="border: 0 !important;" class="feedback-card" *ngIf="selectedPreviousStudentAnswer?.version == 'V1'" [innerHTML]="convertedText"></div>
                <div class="feedback-card p-0" *ngIf="selectedPreviousStudentAnswer?.version != 'V1'" style="overflow-x: hidden;border: 0 !important">
                    <div class="row mb-2">
                        <div class="col-12">
                            <h5 style="font-size: 18px" class="mb-0 font-weight-bold">Total Score</h5>
                            <div class="row">
                                <div class="col-10">
                                    <div class="progress cursor my-2">
                                        <div class="progress-bar"
                                             role="progressbar"
                                             [style.width.%]="scorePercentage"
                                             [attr.aria-valuenow]="score"
                                             [attr.aria-valuemin]="0"
                                             [attr.aria-valuemax]="totalScore">
                                        </div>
                                    </div>
                                </div>
                                <span class="align-self-center font-weight-bold color-primary">{{selectedPreviousStudentAnswer?.student_score}} / {{selectedPreviousStudentAnswer?.total_score}}</span>
                            </div>
                        </div>
                    </div>

                    <div class="feedback-panel" [ngClass]="last ? 'feedback-panel_last' : first ? 'feedback-panel_first' : ''"
                         *ngFor="let feedback of feedbackList; let last = last; let first = first" (click)="feedback.collaspsed = !feedback.collaspsed">
                        <div class="feedback-header d-flex justify-content-between align-items-center"
                             [ngClass]="!feedback.collaspsed ? 'open' : ''">
                            <span class="title-text">{{ getValue(feedback[0]) ?? '-' }}</span>
                            <div class="d-flex align-items-center">
                                            <span class="badge badge-info mr-2">
                                                Score: {{ feedback[1]?.score }} / {{ totalIndivialScore }}
                                            </span>
                                <i style="color: black" class="fa" [ngClass]="feedback.collaspsed ? 'fa-chevron-down' : 'fa-chevron-up'"></i>
                            </div>
                        </div>

                        <div [ngbCollapse]="feedback.collaspsed" class="feedback-body">
                            <div *ngIf="feedback[1]?.rationale" class="rationale_design col-12 px-0 {{feedback[1]?.feedback.length == 0 ? 'mb-0' : ''}}">
                                <strong style="color: black">Rationale:</strong> {{ feedback[1]?.rationale }}
                            </div>

                            <div class="row">
                                <div class="col-md-12 {{lastValue ? '' : 'mb-2'}}" *ngFor="let value of feedback[1]?.feedback; let lastValue = last">
                                    <div class="collapse-card">
                                        <h5 class="snippet-text">
                                            {{ value.snippet }}
                                        </h5>

                                        <div class="inner-collapse mt-2">
                                            <label class="font-weight-bold col-12 px-0">Suggestion: <span class="font-weight-normal italic">{{ value.suggestion }}</span></label>

                                            <label *ngIf="value?.why" class="font-weight-bold mt-2 col-12 px-0">Why: <span class="font-weight-normal italic">{{ value.why }}</span></label>

                                            <label *ngIf="value?.example_rewrite" class="font-weight-bold mt-2 col-12 px-0">Example: <span class="font-weight-normal color-primary italic">{{ value.example_rewrite }}</span></label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-12 mt-3 px-0" *ngIf="selectedPreviousStudentAnswer.next_edit_plan">
        <div class="card">
            <div class="card-header p-3 background_gradient">
                <h5 style="color: white;font-size: 16px" class="font-weight-bold">Next Edit Plan</h5>
            </div>
            <div class="card-body custom_feedback_card_body py-3 px-0">
                <div class="col-12 row {{!last ? 'mb-2' : ''}}" *ngFor="let data of selectedPreviousStudentAnswer.next_edit_plan; let i = index; let last = last">
                    <div [ngStyle]="{'width' : env.deviceType() ? '7%' : !env.deviceType() && feedbackExpanded ? '4%' : '6%'}"
                         style="padding-left: 16px" class="text-center font-weight-bold">{{data?.priority ?? i}}.</div>
                    <div [ngStyle]="{'width' : env.deviceType() ? '93%' : !env.deviceType() && feedbackExpanded ? '96%' : '94%'}">
                        <label class="font-weight-bold mb-1 col-12 px-0">{{data?.action ?? ''}}</label>
                        <label class="col-12 px-0" style="color: #007BFF">Example: <span class="color-primary">{{data.example_rewrite}}</span></label>
                    </div>
                </div>
            </div>
        </div>
    </div>
</ng-template>
